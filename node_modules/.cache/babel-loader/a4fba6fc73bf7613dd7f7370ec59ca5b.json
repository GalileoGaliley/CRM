{"ast":null,"code":"import{DateTime}from\"luxon\";import{store}from\"../store\";export function getDateRangeByPreset(preset,min_date,max_date){var user=store.getState().user;var timeZone=user===null||user===void 0?void 0:user.time_zone;var now=DateTime.now().setZone(timeZone).startOf('day');min_date=DateTime.fromJSDate(min_date).setZone(timeZone).startOf('day').toJSDate();max_date=DateTime.fromJSDate(max_date).setZone(timeZone).endOf('day').toJSDate();if(preset==='last_7_days')return{min_date:now.minus({days:6}).toJSDate(),max_date:now.endOf('day').toJSDate()};if(preset==='last_14_days')return{min_date:now.minus({days:13}).toJSDate(),max_date:now.endOf('day').toJSDate()};if(preset==='last_30_days')return{min_date:now.minus({days:29}).toJSDate(),max_date:now.endOf('day').toJSDate()};if(preset==='last_business_week')return{min_date:now.minus({weeks:1}).set({weekday:1}).toJSDate(),max_date:now.minus({weeks:1}).set({weekday:5}).endOf('day').toJSDate()};if(preset==='last_month')return{min_date:now.minus({months:1}).startOf('month').toJSDate(),max_date:now.minus({months:1}).endOf('month').endOf('day').toJSDate()};if(preset==='this_month')return{min_date:now.startOf('month').toJSDate(),max_date:now.endOf('month').toJSDate()};if(preset==='this_week_mon_today')return{min_date:now.minus({weeks:1}).set({weekday:1}).toJSDate(),max_date:now.endOf('day').toJSDate()};if(preset==='this_week_sun_today')return{min_date:now.set({weekday:0}).toJSDate(),max_date:now.endOf('day').toJSDate()};if(preset==='today')return{min_date:now.startOf('day').toJSDate(),max_date:now.endOf('day').toJSDate()};if(preset==='tomorrow')return{min_date:now.plus({days:1}).startOf('day').toJSDate(),max_date:now.plus({days:1}).endOf('day').toJSDate()};if(preset==='tomorrow_and_next')return{min_date:now.plus({days:1}).toJSDate(),max_date:function(){if(DateTime.fromJSDate(max_date)<now.plus({days:1}))return now.plus({days:1}).endOf('day').toJSDate();return max_date;}()};if(preset==='yesterday')return{min_date:now.minus({days:1}).startOf('day').toJSDate(),max_date:now.minus({days:1}).endOf('day').toJSDate()};if(preset==='last_week_sun_sat')return{min_date:now.minus({weeks:1}).set({weekday:0}).toJSDate(),max_date:now.minus({weeks:1}).set({weekday:6}).endOf('day').toJSDate()};if(preset==='last_week_mon_sun')return{min_date:now.minus({weeks:1}).set({weekday:1}).toJSDate(),max_date:now.set({weekday:0}).endOf('day').toJSDate()};return{min_date:min_date,max_date:max_date};}","map":{"version":3,"sources":["/Users/nicole/rrrr/crm/src/funcs/reports.ts"],"names":["DateTime","store","getDateRangeByPreset","preset","min_date","max_date","user","getState","timeZone","time_zone","now","setZone","startOf","fromJSDate","toJSDate","endOf","minus","days","weeks","set","weekday","months","plus"],"mappings":"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","sourcesContent":["import {DateTime} from \"luxon\"\nimport { DateRangePreset } from \"../models/Misc\"\nimport {store} from \"../store\";\n\nexport function getDateRangeByPreset(preset: DateRangePreset, min_date: Date, max_date: Date): {\n  min_date: Date,\n  max_date: Date,\n\n} {\n  let user = store.getState().user;\n  let timeZone = user?.time_zone;\n\n  const now = DateTime.now().setZone(timeZone).startOf('day')\n\n  min_date = DateTime.fromJSDate(min_date).setZone(timeZone).startOf('day').toJSDate()\n  max_date = DateTime.fromJSDate(max_date).setZone(timeZone).endOf('day').toJSDate();\n\n  if (preset === 'last_7_days')\n    return {\n      min_date: now.minus({days: 6}).toJSDate(),\n      max_date: now.endOf('day').toJSDate(),\n    }\n  \n  if (preset === 'last_14_days')\n    return {\n      min_date: now.minus({days: 13}).toJSDate(),\n      max_date: now.endOf('day').toJSDate(),\n    }\n  \n  if (preset === 'last_30_days')\n    return {\n      min_date: now.minus({days: 29}).toJSDate(),\n      max_date: now.endOf('day').toJSDate(),\n    }\n  \n  if (preset === 'last_business_week')\n    return {\n      min_date: now.minus({weeks: 1}).set({weekday: 1}).toJSDate(),\n      max_date: now.minus({weeks: 1}).set({weekday: 5}).endOf('day').toJSDate(),\n    }\n  \n  if (preset === 'last_month')\n    return {\n      min_date: now.minus({months: 1}).startOf('month').toJSDate(),\n      max_date: now.minus({months: 1}).endOf('month').endOf('day').toJSDate(),\n    }\n  \n  if (preset === 'this_month')\n    return {\n      min_date: now.startOf('month').toJSDate(),\n      max_date: now.endOf('month').toJSDate(),\n    }\n  \n  if (preset === 'this_week_mon_today')\n    return {\n      min_date: now.minus({weeks: 1}).set({weekday: 1}).toJSDate(),\n      max_date: now.endOf('day').toJSDate(),\n    }\n  \n  if (preset === 'this_week_sun_today')\n    return {\n      min_date: now.set({weekday: 0}).toJSDate(),\n      max_date: now.endOf('day').toJSDate(),\n    }\n  \n  if (preset === 'today')\n    return {\n      min_date: now.startOf('day').toJSDate(),\n      max_date: now.endOf('day').toJSDate(),\n    }\n  \n  if (preset === 'tomorrow')\n    return {\n      min_date: now.plus({days: 1}).startOf('day').toJSDate(),\n      max_date: now.plus({days: 1}).endOf('day').toJSDate(),\n    }\n  \n  if (preset === 'tomorrow_and_next')\n    return {\n      min_date: now.plus({days: 1}).toJSDate(),\n      max_date: (() => {\n\n        if (DateTime.fromJSDate(max_date) < now.plus({days: 1}))\n          return now.plus({ days: 1 }).endOf('day').toJSDate()\n        \n        return max_date\n      })(),\n    }\n  \n  if (preset === 'yesterday')\n    return {\n      min_date: now.minus({days: 1}).startOf('day').toJSDate(),\n      max_date: now.minus({days: 1}).endOf('day').toJSDate(),\n    }\n  \n  if (preset === 'last_week_sun_sat')\n    return {\n      min_date: now.minus({weeks: 1}).set({weekday: 0}).toJSDate(),\n      max_date: now.minus({weeks: 1}).set({weekday: 6}).endOf('day').toJSDate(),\n    }\n  \n  if (preset === 'last_week_mon_sun')\n    return {\n      min_date: now.minus({weeks: 1}).set({weekday: 1}).toJSDate(),\n      max_date: now.set({weekday: 0}).endOf('day').toJSDate(),\n    }\n  \n  return {min_date, max_date}\n}\n"]},"metadata":{},"sourceType":"module"}