{"ast":null,"code":"import _asyncToGenerator from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/regenerator/index.js\";import axios from\"axios\";import router from'./router';export function getActiveAccount(store){if(store.selectedAccount===null)return null;return store.accounts[store.selectedAccount];}export function signIn(_x,_x2){return _signIn.apply(this,arguments);}function _signIn(){_signIn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(email,password){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return httpClient.post('/login',{email:email,password:password}).then(function(_ref){var data=_ref.data;data=JSON.parse(data);localStorage.setItem('token',data.token);});case 3:_context.next=7;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);case 7:// Redirect to auth page\nrouter.navigate('auth');case 8:case\"end\":return _context.stop();}}},_callee,null,[[0,5]]);}));return _signIn.apply(this,arguments);}export function signOut(_x3){return _signOut.apply(this,arguments);}function _signOut(){_signOut=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatcher){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatcher.setAccessToken(null);dispatcher.setAccounts([]);dispatcher.setSelectedAccount(null);dispatcher.setUser(null);// Perform logout\n_context2.prev=4;_context2.next=7;return httpClient.post('/logout');case 7:_context2.next=11;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](4);case 11:delete httpClient.defaults.headers['Authorization'];// Redirect to auth page\nrouter.navigate('auth');case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[4,9]]);}));return _signOut.apply(this,arguments);}export function nError(error){// HTTP error (axios)\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nif(error.isAxiosError){var _error=error;// eslint-disable-next-line no-console\nconsole.warn(_error.request,_error.response);if(!_error.response)return{content:{errorText:\"Can`t connect to server\"},error:error};var errorText=_error.response.data.message;return{content:{errorText:errorText},error:error};}// Another error\nelse{// eslint-disable-next-line no-console\nconsole.error(error);}// Return error content\nreturn{content:{errorText:String(error)},error:error};}export var httpClient=axios.create({baseURL:'http://crm56new.artemiudintsev.com/api'});export function leadingZero(int){return(int<=9?'0':'')+int;}export function formatTime(seconds){return[0,Math.floor(seconds/60),Math.floor(seconds%60)].map(function(x){return x.toString();}).map(function(x){return x.length===1?\"0\".concat(x):x;}).join(\":\");}export function calculatePercent(min,max){return min/max*100;}export function calculateFromPercent(value,min,max){return max/100*value;}","map":{"version":3,"sources":["/Users/nicole/rrrr/crm/src/funcs.ts"],"names":["axios","router","getActiveAccount","store","selectedAccount","accounts","signIn","email","password","httpClient","post","then","data","JSON","parse","localStorage","setItem","token","navigate","signOut","dispatcher","setAccessToken","setAccounts","setSelectedAccount","setUser","defaults","headers","nError","error","isAxiosError","_error","console","warn","request","response","content","errorText","message","String","create","baseURL","leadingZero","int","formatTime","seconds","Math","floor","map","x","toString","length","join","calculatePercent","min","max","calculateFromPercent","value"],"mappings":"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","sourcesContent":["import axios, { AxiosError } from \"axios\"\nimport Account from \"./models/Account\";\nimport { StoreDispatch, StoreState } from \"./store\";\nimport router from './router'\nimport {strict} from \"assert\";\n\nexport function getActiveAccount(store: StoreState): Account | null {\n  if(store.selectedAccount === null) return null\n  return store.accounts[store.selectedAccount]\n}\n\nexport async function signIn(email : string, password: string) {\n  // login\n  try {\n    await httpClient.post('/login',{email, password}).then(({data})=>{\n      data = JSON.parse(data);\n      localStorage.setItem('token', data.token);\n    })\n  } catch(e) {\n\n  }\n\n\n\n\n\n  // Redirect to auth page\n  router.navigate('auth')\n}\n\nexport async function signOut(dispatcher: StoreDispatch) {\n  dispatcher.setAccessToken(null)\n  dispatcher.setAccounts([])\n  dispatcher.setSelectedAccount(null)\n  dispatcher.setUser(null)\n\n  // Perform logout\n  try {await httpClient.post('/logout')} catch(e) {}\n  delete httpClient.defaults.headers['Authorization']\n\n  // Redirect to auth page\n  router.navigate('auth')\n}\n\nexport function nError(error: Error | AxiosError | unknown): {\n\n  error: Error | AxiosError | unknown,\n  content: {\n    code?: number,\n    errorText: string\n  }\n} {\n\n  // HTTP error (axios)\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  if ((<any>error).isAxiosError) {\n    const _error = <AxiosError>error\n    // eslint-disable-next-line no-console\n    console.warn(_error.request, _error.response)\n\n    if (!_error.response) return {\n      content: {\n        errorText: \"Can`t connect to server\"\n      },\n      error\n    }\n\n    const errorText = _error.response.data.message\n\n    return {\n      content: {\n        errorText\n      },\n      error\n    }\n  }\n\n  // Another error\n  else {\n    // eslint-disable-next-line no-console\n    console.error(error)\n  }\n\n  // Return error content\n  return {\n    content: {\n      errorText: String(error)\n    },\n    error\n  }\n}\n\nexport const httpClient = axios.create({\n  baseURL: 'http://crm56new.artemiudintsev.com/api'\n})\n\nexport function leadingZero(int: number) {\n  return (int <= 9 ? '0' : '') + int\n}\n\nexport function formatTime(seconds: number) {\n  return (\n    [\n      0,\n      Math.floor(seconds / 60),\n      Math.floor(seconds % 60),\n    ]\n      .map(x => x.toString())\n      .map(x => (x.length === 1 ? `0${x}` : x))\n      .join(\":\")\n  );\n}\n\nexport function calculatePercent(min: number, max: number) {\n  return min / max * 100\n}\n\nexport function calculateFromPercent(value: number, min: number, max: number) {\n  return max / 100 * value\n}\n"]},"metadata":{},"sourceType":"module"}