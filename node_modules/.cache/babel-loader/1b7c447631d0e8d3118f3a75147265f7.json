{"ast":null,"code":"import _objectSpread from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/regenerator/index.js\";import classNames from\"classnames\";import{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import{BaseLink,useRoute}from\"react-router5\";import Icon from\"../../../components/Icon\";import ReportFilters from\"../../../components/reports/Filters\";import ReportTableControls from\"../../../components/reports/TableControls\";import ReportTableField from\"../../../components/reports/TableField\";import{httpClient,nError}from\"../../../funcs/base\";import{mapDispatchToProps,mapStateToProps}from\"../../../store\";import\"../../../styles/pages/common/report-list.sass\";import{getActiveAccount}from\"../../../funcs\";import qs from\"qs\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CallCenter_CallGroupsPage_List=connect(mapStateToProps,mapDispatchToProps)(function(props){var $router=useRoute();var activeAccount=getActiveAccount(props.store);var _useState=useState(Math.random()),_useState2=_slicedToArray(_useState,2),$updater=_useState2[0],$setUpdater=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),reportData=_useState4[0],setReportData=_useState4[1];var _useState5=useState({search:'',page:1,sort:{field:'name',direction:'up'},sortFields:[{span:'Name',value:'name'},{span:'Dispatchers',value:'dispatchers'},{span:'Call Flow',value:'call_flows'}]}),_useState6=_slicedToArray(_useState5,2),localInterface=_useState6[0],setLocalInterface=_useState6[1];// Load callGroups function\nfunction loadCallGroups(){return _loadCallGroups.apply(this,arguments);}// Load clients on page mount\nfunction _loadCallGroups(){_loadCallGroups=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _ref,dipsatchersReport;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:httpClient.defaults.headers['Authorization']=\"Bearer \".concat(props.store.accessToken);_context.prev=1;_context.next=4;return httpClient.post('/callgroups/report',qs.stringify(_objectSpread({account_id:activeAccount.account_id,limit_rows:props.store.reportsMaxRows,page:localInterface.page,sort_field:localInterface.sort.field,sort_type:localInterface.sort.direction==='up'?'asc':'desc'},localInterface.search?{search:localInterface.search}:{})));case 4:_ref=_context.sent;dipsatchersReport=_ref.data;setReportData(dipsatchersReport);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);nError(_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return _loadCallGroups.apply(this,arguments);}useEffect(function(){loadCallGroups();},[$updater,localInterface.page]);// Render function\nreturn/*#__PURE__*/_jsx(_Fragment,{children:reportData?/*#__PURE__*/_jsxs(\"div\",{className:\"CallCenter_CallGroupsPage_List\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"top-nav\",children:[/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.phoneNumbers\",className:classNames({_active:$router.route.name===\"call_center.phoneNumbers\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"phone-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Phone Numbers\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.dispatchers\",className:classNames({_active:$router.route.name===\"call_center.dispatchers\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"user-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Dispatchers\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.groups\",className:classNames({_active:$router.route.name===\"call_center.groups\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"user-29\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Groups\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.callFlows\",className:classNames({_active:$router.route.name===\"call_center.callFlows\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"share-7\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Call Flows\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.settings\",className:classNames({_active:$router.route.name===\"call_center.settings\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"gear-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Settings\"})]})]}),/*#__PURE__*/_jsx(ReportFilters,{onSearchInputChange:function onSearchInputChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{search:value}));},onUpdate:function onUpdate(){return loadCallGroups();}}),/*#__PURE__*/_jsx(ReportTableControls,{zIndex:5,onMaxRowsChange:function onMaxRowsChange(){loadCallGroups();},amount:{total:reportData.interface.rows_all,start:reportData.interface.rows_start,end:reportData.interface.rows_end},page:localInterface.page,maxPages:reportData.interface.max_pages,onPagesStart:function onPagesStart(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:1}));},onPrevPage:function onPrevPage(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:localInterface.page-1}));},onNextPage:function onNextPage(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:localInterface.page+1}));},onPagesEnd:function onPagesEnd(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:reportData.interface.max_pages}));},sort:localInterface.sort,sortFields:localInterface.sortFields,onSortFieldChange:function onSortFieldChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:_objectSpread(_objectSpread({},localInterface.sort),{},{field:value})}));},onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:_objectSpread(_objectSpread({},localInterface.sort),{},{direction:value})}));},onSortFire:function onSortFire(){return $setUpdater(Math.random());},addButton:/*#__PURE__*/_jsx(\"div\",{className:\"add-button-wrapper\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"_iconed _rounded add-button\",onClick:function onClick(){return $router.router.navigate('call_center.groups.new',{},{reload:true});},children:[/*#__PURE__*/_jsx(Icon,{icon:\"plus-thin\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Add Group\"}),/*#__PURE__*/_jsx(Icon,{icon:\"user-29\"})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"contents\",children:[/*#__PURE__*/_jsxs(\"table\",{className:classNames('table','__show-on-wide',{__respectAsidePanel:props.store.navActive.is}),children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(ReportTableField,{contents:/*#__PURE__*/_jsx(\"span\",{children:\"Name\"}),sortDirection:localInterface.sort.field==='name'?localInterface.sort.direction:undefined,onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:{field:'name',direction:value}}));},onFilterFire:function onFilterFire(){return $setUpdater(Math.random());}}),/*#__PURE__*/_jsx(ReportTableField,{contents:/*#__PURE__*/_jsx(\"span\",{children:\"Dispatchers\"}),sortDirection:localInterface.sort.field==='dispatchers'?localInterface.sort.direction:undefined,onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:{field:'dispatchers',direction:value}}));},onFilterFire:function onFilterFire(){return $setUpdater(Math.random());}}),/*#__PURE__*/_jsx(ReportTableField,{contents:/*#__PURE__*/_jsx(\"span\",{children:\"Call Flow\"}),sortDirection:localInterface.sort.field==='call_flows'?localInterface.sort.direction:undefined,onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:{field:'call_flows',direction:value}}));},onFilterFire:function onFilterFire(){return $setUpdater(Math.random());}})]}),reportData.call_groups.map(function(callGroup,i){return/*#__PURE__*/_jsxs(\"tr\",{onClick:function onClick(){return $router.router.navigate('call_center.groups.item',{},{reload:true});},children:[/*#__PURE__*/_jsx(\"td\",{children:callGroup.name}),/*#__PURE__*/_jsx(\"td\",{children:callGroup.dispatchers}),/*#__PURE__*/_jsx(\"td\",{children:callGroup.call_flows})]},i);})]}),/*#__PURE__*/_jsxs(\"table\",{className:classNames('table','__hide-on-wide','__hide-on-mobile',{__respectAsidePanel:props.store.navActive.is}),children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Dispatchers\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Call Flow\"})]}),reportData.call_groups.map(function(callGroup,i){return/*#__PURE__*/_jsxs(\"tr\",{onClick:function onClick(){return $router.router.navigate('call_center.groups.item',{},{reload:true});},children:[/*#__PURE__*/_jsx(\"td\",{children:callGroup.name}),/*#__PURE__*/_jsx(\"td\",{children:callGroup.dispatchers}),/*#__PURE__*/_jsx(\"td\",{children:callGroup.call_flows})]},i);})]}),/*#__PURE__*/_jsx(\"div\",{className:classNames('mobile-table-items','__show-on-mobile',{__respectAsidePanel:props.store.navActive.is}),children:reportData.call_groups.map(function(callGroup,i){return/*#__PURE__*/_jsxs(\"div\",{className:\"item\",onClick:function onClick(){return $router.router.navigate('call_center.groups.item',{},{reload:true});},children:[/*#__PURE__*/_jsx(\"div\",{className:\"__top\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"b\",{children:callGroup.name})}),/*#__PURE__*/_jsx(\"div\",{children:callGroup.dispatchers})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"__bottom\",children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"__right\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"b\",{children:callGroup.call_flows})})})]})]},i);})})]}),/*#__PURE__*/_jsx(ReportTableControls,{isUnder:true,onMaxRowsChange:function onMaxRowsChange(){return $setUpdater(Math.random());},amount:{total:reportData.interface.rows_all,start:reportData.interface.rows_start,end:reportData.interface.rows_end},page:localInterface.page,maxPages:reportData.interface.max_pages,onPagesStart:function onPagesStart(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:1}));},onPrevPage:function onPrevPage(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:localInterface.page-1}));},onNextPage:function onNextPage(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:localInterface.page+1}));},onPagesEnd:function onPagesEnd(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:reportData.interface.max_pages}));},sort:localInterface.sort,sortFields:localInterface.sortFields,onSortFieldChange:function onSortFieldChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:_objectSpread(_objectSpread({},localInterface.sort),{},{field:value})}));},onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:_objectSpread(_objectSpread({},localInterface.sort),{},{direction:value})}));},onSortFire:function onSortFire(){return $setUpdater(Math.random());}})]}):null});});export default CallCenter_CallGroupsPage_List;","map":{"version":3,"sources":["/Users/nicole/rrrr/crm/src/pages/CallCenter/CallGroups/List.tsx"],"names":["classNames","useEffect","useState","connect","BaseLink","useRoute","Icon","ReportFilters","ReportTableControls","ReportTableField","httpClient","nError","mapDispatchToProps","mapStateToProps","getActiveAccount","qs","CallCenter_CallGroupsPage_List","props","$router","activeAccount","store","Math","random","$updater","$setUpdater","reportData","setReportData","search","page","sort","field","direction","sortFields","span","value","localInterface","setLocalInterface","loadCallGroups","defaults","headers","accessToken","post","stringify","account_id","limit_rows","reportsMaxRows","sort_field","sort_type","dipsatchersReport","data","router","_active","route","name","total","interface","rows_all","start","rows_start","end","rows_end","max_pages","navigate","reload","__respectAsidePanel","navActive","is","undefined","call_groups","map","callGroup","i","dispatchers","call_flows"],"mappings":"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","sourcesContent":["import axios from \"axios\"\nimport classNames from \"classnames\"\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { BaseLink, useRoute } from \"react-router5\"\nimport Checkbox from \"../../../components/Checkbox\"\nimport Icon from \"../../../components/Icon\"\nimport ReportFilters from \"../../../components/reports/Filters\"\nimport ReportTableControls from \"../../../components/reports/TableControls\"\nimport ReportTableField from \"../../../components/reports/TableField\"\nimport { httpClient, nError } from \"../../../funcs/base\"\nimport { CallCenter_CallGroup } from \"../../../models/CallCenter\"\nimport Client from \"../../../models/Client\"\nimport { StoreDispatch, StoreState, mapDispatchToProps, mapStateToProps } from \"../../../store\";\n\nimport \"../../../styles/pages/common/report-list.sass\"\nimport {getActiveAccount} from \"../../../funcs\";\nimport Account from \"../../../models/Account\";\nimport qs from \"qs\";\n\ninterface Props {\n  store: StoreState,\n  dispatcher: StoreDispatch\n}\n\ninterface CallGroupsReport {\n\n  interface: {\n\n    max_pages: number,\n    rows_start: number,\n    rows_end: number,\n    rows_all: number,\n  },\n\n  permissions: {\n    show_call_group: boolean,\n    add_call_group: boolean\n  },\n\n  call_groups: CallCenter_CallGroup[]\n}\n\nconst CallCenter_CallGroupsPage_List = connect(mapStateToProps, mapDispatchToProps)(function(props: Props) {\n\n  const $router = useRoute();\n\n  const activeAccount = getActiveAccount(props.store) as Account;\n  const [$updater, $setUpdater] = useState<any>(Math.random());\n\n  const [reportData, setReportData] = useState<CallGroupsReport | null>(null);\n  const [localInterface, setLocalInterface] = useState({\n\n    search: '',\n\n    page: 1,\n\n    sort: {\n      field: 'name',\n      direction: 'up' as 'up' | 'down'\n    },\n    sortFields: [{\n      span: 'Name',\n      value: 'name'\n    },{\n      span: 'Dispatchers',\n      value: 'dispatchers'\n    },{\n      span: 'Call Flow',\n      value: 'call_flows'\n    }]\n\n  })\n\n  // Load callGroups function\n  async function loadCallGroups() {\n\n    httpClient.defaults.headers['Authorization'] = `Bearer ${props.store.accessToken}`\n\n    try {\n      const { data: dipsatchersReport } = (await httpClient.post('/callgroups/report', qs.stringify({\n        account_id: activeAccount.account_id,\n        limit_rows: props.store.reportsMaxRows,\n        page: localInterface.page,\n        sort_field: localInterface.sort.field,\n        sort_type: localInterface.sort.direction === 'up' ? 'asc' : 'desc',\n        ...(localInterface.search ? {search: localInterface.search} : {})\n      }))) as {data: CallGroupsReport}\n\n      setReportData(dipsatchersReport)\n    }\n    catch (error) {\n      nError(error)\n    }\n  }\n\n  // Load clients on page mount\n  useEffect(() => { loadCallGroups() }, [\n    $updater,\n    localInterface.page,\n  ])\n\n  // Render function\n  return (<>\n    {reportData ? (\n      <div className=\"CallCenter_CallGroupsPage_List\" >\n\n        {/* Top navigation */}\n        <div className=\"top-nav\">\n          <BaseLink router={$router.router} routeName=\"call_center.phoneNumbers\" className={classNames({_active: $router.route.name === \"call_center.phoneNumbers\"})}>\n            <Icon icon=\"phone-1\" />\n            <span>Phone Numbers</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.dispatchers\" className={classNames({_active: $router.route.name === \"call_center.dispatchers\"})}>\n            <Icon icon=\"user-1\" />\n            <span>Dispatchers</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.groups\" className={classNames({_active: $router.route.name === \"call_center.groups\"})}>\n            <Icon icon=\"user-29\" />\n            <span>Groups</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.callFlows\" className={classNames({_active: $router.route.name === \"call_center.callFlows\"})}>\n            <Icon icon=\"share-7\" />\n            <span>Call Flows</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.settings\" className={classNames({_active: $router.route.name === \"call_center.settings\"})}>\n            <Icon icon=\"gear-1\" />\n            <span>Settings</span>\n          </BaseLink>\n        </div>\n\n        { /* List filters */}\n        <ReportFilters\n          onSearchInputChange={(value) => setLocalInterface({...localInterface, search: value})}\n\n          onUpdate={() => loadCallGroups()}\n        />\n\n        {/* Table controls */}\n        <ReportTableControls\n          zIndex={5}\n          \n          onMaxRowsChange={() => {\n            loadCallGroups();\n\n          }}\n\n          amount={{\n            total: reportData.interface.rows_all,\n            start: reportData.interface.rows_start,\n            end: reportData.interface.rows_end\n          }}\n\n          page={localInterface.page}\n          maxPages={reportData.interface.max_pages}\n          onPagesStart={() => setLocalInterface({...localInterface, page: 1})}\n          onPrevPage={() => setLocalInterface({...localInterface, page: localInterface.page-1})}\n          onNextPage={() => setLocalInterface({...localInterface, page: localInterface.page+1})}\n          onPagesEnd={() => setLocalInterface({...localInterface, page: reportData.interface.max_pages})}\n          \n          sort={localInterface.sort}\n          sortFields={localInterface.sortFields}\n          onSortFieldChange={(value) => setLocalInterface({...localInterface, sort: {...localInterface.sort, field: value}})}\n          onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {...localInterface.sort, direction: value}})}\n          onSortFire={() => $setUpdater(Math.random())}\n\n          addButton={(\n            <div className=\"add-button-wrapper\">\n              <button className=\"_iconed _rounded add-button\" onClick={() => $router.router.navigate('call_center.groups.new', {}, {reload: true})}>\n                <Icon icon=\"plus-thin\" />\n                <span>Add Group</span>\n                <Icon icon=\"user-29\" />\n              </button>\n            </div>\n          )}\n        />\n\n        <div className=\"contents\">\n\n          {/* Wide desktop table */}\n          <table className={classNames('table', '__show-on-wide', {\n            __respectAsidePanel: props.store.navActive.is\n          })}>\n            <tr>\n              <ReportTableField\n                contents={(<span>Name</span>)}\n\n                sortDirection={localInterface.sort.field === 'name' ? localInterface.sort.direction : undefined}\n                onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {field: 'name', direction: value}})}\n\n                onFilterFire={() => $setUpdater(Math.random())}\n              />\n              <ReportTableField\n                contents={(<span>Dispatchers</span>)}\n\n                sortDirection={localInterface.sort.field === 'dispatchers' ? localInterface.sort.direction : undefined}\n                onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {field: 'dispatchers', direction: value}})}\n\n                onFilterFire={() => $setUpdater(Math.random())}\n              />\n              <ReportTableField\n                contents={(<span>Call Flow</span>)}\n\n                sortDirection={localInterface.sort.field === 'call_flows' ? localInterface.sort.direction : undefined}\n                onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {field: 'call_flows', direction: value}})}\n\n                onFilterFire={() => $setUpdater(Math.random())}\n              />\n            </tr>\n            {reportData.call_groups.map((callGroup, i) => (\n              <tr key={i} onClick={() => $router.router.navigate('call_center.groups.item', {}, {reload: true})}>\n                <td>{callGroup.name}</td>\n                <td>{callGroup.dispatchers}</td>\n                <td>{callGroup.call_flows}</td>\n              </tr>\n            ))}\n          </table>\n\n          {/* Medium screen table */}\n          <table className={classNames('table', '__hide-on-wide', '__hide-on-mobile', {\n            __respectAsidePanel: props.store.navActive.is\n          })}>\n            <tr>\n              <th>Name</th>\n              <th>Dispatchers</th>\n              <th>Call Flow</th>\n            </tr>\n            {reportData.call_groups.map((callGroup, i) => (\n              <tr key={i} onClick={() => $router.router.navigate('call_center.groups.item', {}, {reload: true})}>\n                <td>{callGroup.name}</td>\n                <td>{callGroup.dispatchers}</td>\n                <td>{callGroup.call_flows}</td>\n              </tr>\n            ))}\n          </table>\n\n          {/* Mobile table items */}\n          <div className={classNames('mobile-table-items', '__show-on-mobile', {\n            __respectAsidePanel: props.store.navActive.is\n          })}>\n\n            {reportData.call_groups.map((callGroup, i: number) => (\n              <div className=\"item\" key={i} onClick={() => $router.router.navigate('call_center.groups.item', {}, {reload: true})}>\n\n                <div className=\"__top\">\n\n                  <div className=\"__left\">\n                    <div><b>{callGroup.name}</b></div>\n                    <div>\n                      {callGroup.dispatchers}\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"__bottom\">\n                  <div></div>\n\n                  <div className=\"__right\">\n                    <div>\n                      <b>{callGroup.call_flows}</b>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Table controls */}\n        <ReportTableControls\n          isUnder={true}\n\n          onMaxRowsChange={() => $setUpdater(Math.random())}\n\n          amount={{\n            total: reportData.interface.rows_all,\n            start: reportData.interface.rows_start,\n            end: reportData.interface.rows_end\n          }}\n\n          page={localInterface.page}\n          maxPages={reportData.interface.max_pages}\n          onPagesStart={() => setLocalInterface({...localInterface, page: 1})}\n          onPrevPage={() => setLocalInterface({...localInterface, page: localInterface.page-1})}\n          onNextPage={() => setLocalInterface({...localInterface, page: localInterface.page+1})}\n          onPagesEnd={() => setLocalInterface({...localInterface, page: reportData.interface.max_pages})}\n          \n          sort={localInterface.sort}\n          sortFields={localInterface.sortFields}\n          onSortFieldChange={(value) => setLocalInterface({...localInterface, sort: {...localInterface.sort, field: value}})}\n          onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {...localInterface.sort, direction: value}})}\n          onSortFire={() => $setUpdater(Math.random())}\n        />\n      </div>\n    ) : null}\n  </>)\n})\nexport default CallCenter_CallGroupsPage_List\n"]},"metadata":{},"sourceType":"module"}