{"ast":null,"code":"import _objectSpread from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/regenerator/index.js\";import axios from\"axios\";import{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import Icon from\"../../../components/Icon\";import{nError}from\"../../../funcs\";import{mapDispatchToProps,mapStateToProps}from\"../../../store\";import\"../../../styles/pages/common/entity-edit.sass\";import Select from\"../../../components/Select\";import Checkbox from\"../../../components/Checkbox\";import{BaseLink,useRoute}from\"react-router5\";import classNames from\"classnames\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var emptyDispatcher={dispatcher_id:'',name:'',user:'',phone:'',is_phone:false,is_softphone:false,active:'Active',groups:'',\"created_at\":\"05/04/2021 09:32am\",\"created_by\":\"Alex\",\"last_edited_at\":\"05/04/2021 10:34am\",\"last_edited_by\":\"Alex\"};var CallCenter_CallGroupsPage_New=connect(mapStateToProps,mapDispatchToProps)(function(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),readyToSave=_useState2[0],setReadyToSave=_useState2[1];var $router=useRoute();var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),dispatchers=_useState4[0],setDispatchers=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),availableDispatchers=_useState6[0],setAvailableDispatchers=_useState6[1];var _useState7=useState(emptyDispatcher),_useState8=_slicedToArray(_useState7,2),selectedDispatcher=_useState8[0],setSelectedDispatcher=_useState8[1];var _useState9=useState({name:'',dispatchers:[]}),_useState10=_slicedToArray(_useState9,2),newCallGroupData=_useState10[0],setNewCallGroupData=_useState10[1];// Load info function\nfunction loadInfo(){return _loadInfo.apply(this,arguments);}// Load callGroup data\nfunction _loadInfo(){_loadInfo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,callGroupsData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('/json/call_center_call_groups.json');case 3:_yield$axios$get=_context.sent;callGroupsData=_yield$axios$get.data;setDispatchers(callGroupsData.edit.dispatchers);setAvailableDispatchers([emptyDispatcher].concat(callGroupsData.edit.dispatchers));setSelectedDispatcher([emptyDispatcher].concat(callGroupsData.edit.dispatchers)[0]);setTimeout(function(){return setReadyToSave(false);},100);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);nError(_context.t0);case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return _loadInfo.apply(this,arguments);}useEffect(function(){loadInfo();},[]);// Add dispatcher function\nfunction addDispatcher(){if(!newCallGroupData.dispatchers||!newCallGroupData)return;var newDispatchersList=[].concat(_toConsumableArray(newCallGroupData.dispatchers),[selectedDispatcher]);setNewCallGroupData(_objectSpread(_objectSpread({},newCallGroupData),{},{dispatchers:newDispatchersList}));var _availableDispatchers=_toConsumableArray(availableDispatchers);_availableDispatchers=_availableDispatchers.filter(function($dispatcher){return newDispatchersList.findIndex(function(dispatcher){return dispatcher.name===$dispatcher.name;})===-1;});setAvailableDispatchers(_toConsumableArray(_availableDispatchers));setSelectedDispatcher(emptyDispatcher);setReadyToSave(true);}// Remove dispatcher function\nfunction removeDispatcher(i){var _callGroupDispatchers=_toConsumableArray(newCallGroupData.dispatchers);var _dispatcher=_callGroupDispatchers[i];_callGroupDispatchers.splice(i,1);setNewCallGroupData(_objectSpread(_objectSpread({},newCallGroupData),{},{dispatchers:_callGroupDispatchers}));setAvailableDispatchers([].concat(_toConsumableArray(availableDispatchers),[_dispatcher]));setReadyToSave(true);}useEffect(function(){return setReadyToSave(true);},[newCallGroupData]);// Render function\nreturn/*#__PURE__*/_jsx(_Fragment,{children:true?/*#__PURE__*/_jsxs(\"div\",{className:\"CallCenter_CallGroupsPage_New entity-edit\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"top-nav\",children:[/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.phoneNumbers\",className:classNames({_active:$router.route.name===\"call_center.phoneNumbers\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"phone-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Phone Numbers\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.dispatchers\",className:classNames({_active:$router.route.name===\"call_center.dispatchers\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"user-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Dispatchers\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.groups\",className:classNames({_active:$router.route.name===\"call_center.groups\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"user-29\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Groups\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.callFlows\",className:classNames({_active:$router.route.name===\"call_center.callFlows\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"share-7\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Call Flows\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.settings\",className:classNames({_active:$router.route.name===\"call_center.settings\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"gear-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Settings\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"wrapper flex-container sb\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"New Call Group\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"fieldset\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend\",children:\"Main\"}),/*#__PURE__*/_jsx(\"div\",{className:\"fields\",children:/*#__PURE__*/_jsx(\"div\",{className:\"__left\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(_ref){var value=_ref.target.value;return setNewCallGroupData(_objectSpread(_objectSpread({},newCallGroupData),{},{name:value}));}})]})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fieldset\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-container sb wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend\",children:\"Dispatchers\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"legend-action-wrapper\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Dispatcher:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-wrapper\",children:[/*#__PURE__*/_jsx(Select,{options:availableDispatchers.map(function(dispatcher){return{span:dispatcher.name,value:dispatcher.name};}),selectedOption:selectedDispatcher.name,onChange:function onChange(value){return setSelectedDispatcher(availableDispatchers.find(function(_dispatcher){return _dispatcher.name===value;}));}}),/*#__PURE__*/_jsx(\"button\",{disabled:!selectedDispatcher.name,className:\"_green\",onClick:function onClick(){return addDispatcher();},children:\"Add\"})]})]})]}),/*#__PURE__*/_jsxs(\"table\",{className:classNames('table','__hide-on-mobile',{__respectAsidePanel:props.store.navActive.is}),children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"User\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Phone\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Phone\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Softphone\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Active\"}),/*#__PURE__*/_jsx(\"th\",{})]}),newCallGroupData.dispatchers.map(function(dispatcher,i){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:dispatcher.name}),/*#__PURE__*/_jsx(\"td\",{children:dispatcher.user}),/*#__PURE__*/_jsx(\"td\",{children:dispatcher.phone}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Checkbox,{contents:'',value:dispatcher.is_phone})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Checkbox,{contents:'',value:dispatcher.is_softphone})}),/*#__PURE__*/_jsx(\"td\",{className:classNames({'red-text':dispatcher.active==='Off','green-text':dispatcher.active==='On'}),children:dispatcher.active}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"_zeroed _iconed _red\",onClick:function onClick(){return removeDispatcher(i);},children:/*#__PURE__*/_jsx(Icon,{icon:\"x-mark-1\"})})})]},i);})]}),/*#__PURE__*/_jsx(\"div\",{className:classNames('mobile-table','__show-on-mobile',{__respectAsidePanel:props.store.navActive.is}),children:/*#__PURE__*/_jsx(\"div\",{className:\"mobile-table-items\",children:newCallGroupData.dispatchers.map(function(dispatcher,i){return/*#__PURE__*/_jsxs(\"div\",{className:\"item\",onClick:function onClick(){return $router.router.navigate('call_center.dispatchers.item',{},{reload:true});},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__top\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"b\",{children:dispatcher.name})}),/*#__PURE__*/_jsx(\"div\",{children:dispatcher.user})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"__right small\",children:[/*#__PURE__*/_jsx(\"div\",{className:classNames({'red-text':dispatcher.active==='Inactive','green-text':dispatcher.active==='Active'}),children:dispatcher.active}),/*#__PURE__*/_jsx(\"div\",{children:dispatcher.phone})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"__bottom\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-container\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"gray\",children:\"Phone:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\" \",/*#__PURE__*/_jsx(Checkbox,{contents:\"\",value:dispatcher.is_phone})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-container\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"gray\",children:\"Softphone:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\" \",/*#__PURE__*/_jsx(Checkbox,{contents:\"\",value:dispatcher.is_softphone})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"__right small\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"_zeroed _iconed _red\",onClick:function onClick(e){e.stopPropagation();removeDispatcher(i);},children:/*#__PURE__*/_jsx(Icon,{icon:\"x-mark-1\"})})})})]})]},i);})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper flex-container sb editing-buttons\",children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"_bordered _red\",onClick:function onClick(){return $router.router.navigate('call_center.groups',{},{reload:true});},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{disabled:!readyToSave,className:\"_bordered _green\",children:\"Save\"})]})]})]}):null});});export default CallCenter_CallGroupsPage_New;","map":{"version":3,"sources":["/Users/nicole/rrrr/crm/src/pages/CallCenter/CallGroups/New.tsx"],"names":["axios","useEffect","useState","connect","Icon","nError","mapDispatchToProps","mapStateToProps","Select","Checkbox","BaseLink","useRoute","classNames","emptyDispatcher","dispatcher_id","name","user","phone","is_phone","is_softphone","active","groups","CallCenter_CallGroupsPage_New","props","readyToSave","setReadyToSave","$router","dispatchers","setDispatchers","availableDispatchers","setAvailableDispatchers","selectedDispatcher","setSelectedDispatcher","newCallGroupData","setNewCallGroupData","loadInfo","get","callGroupsData","data","edit","concat","setTimeout","addDispatcher","newDispatchersList","_availableDispatchers","filter","$dispatcher","findIndex","dispatcher","removeDispatcher","i","_callGroupDispatchers","_dispatcher","splice","router","_active","route","value","target","map","span","find","__respectAsidePanel","store","navActive","is","navigate","reload","e","stopPropagation"],"mappings":"siBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,OAASC,OAAT,KAAwB,aAAxB,CACA,MAAOC,CAAAA,IAAP,KAAiB,0BAAjB,CACA,OAASC,MAAT,KAAuB,gBAAvB,CACA,OAAoCC,kBAApC,CAAwDC,eAAxD,KAA+E,gBAA/E,CAEA,MAAO,+CAAP,CACA,MAAOC,CAAAA,MAAP,KAAmB,4BAAnB,CACA,MAAOC,CAAAA,QAAP,KAAqB,8BAArB,CACA,OAASC,QAAT,CAAmBC,QAAnB,KAAmC,eAAnC,CAEA,MAAOC,CAAAA,UAAP,KAAuB,YAAvB,C,6IAOA,GAAMC,CAAAA,eAAsC,CAAG,CAC7CC,aAAa,CAAE,EAD8B,CAE7CC,IAAI,CAAE,EAFuC,CAG7CC,IAAI,CAAE,EAHuC,CAI7CC,KAAK,CAAE,EAJsC,CAK7CC,QAAQ,CAAE,KALmC,CAM7CC,YAAY,CAAE,KAN+B,CAO7CC,MAAM,CAAE,QAPqC,CAQ7CC,MAAM,CAAE,EARqC,CAS7C,aAAc,oBAT+B,CAU7C,aAAc,MAV+B,CAW7C,iBAAkB,oBAX2B,CAY7C,iBAAkB,MAZ2B,CAA/C,CAeA,GAAMC,CAAAA,6BAA6B,CAAGnB,OAAO,CAACI,eAAD,CAAkBD,kBAAlB,CAAP,CAA6C,SAASiB,KAAT,CAAuB,CAExG,cAAsCrB,QAAQ,CAAC,KAAD,CAA9C,wCAAOsB,WAAP,eAAoBC,cAApB,eAEA,GAAMC,CAAAA,OAAO,CAAGf,QAAQ,EAAxB,CAEA,eAAsCT,QAAQ,CAAiC,IAAjC,CAA9C,yCAAOyB,WAAP,eAAoBC,cAApB,eACA,eAAwD1B,QAAQ,CAA0B,EAA1B,CAAhE,yCAAO2B,oBAAP,eAA6BC,uBAA7B,eACA,eAAoD5B,QAAQ,CAAwBW,eAAxB,CAA5D,yCAAOkB,kBAAP,eAA2BC,qBAA3B,eACA,eAAgD9B,QAAQ,CAAC,CACvDa,IAAI,CAAE,EADiD,CAEvDY,WAAW,CAAE,EAF0C,CAAD,CAAxD,0CAAOM,gBAAP,gBAAyBC,mBAAzB,gBAKA;AAdwG,QAezFC,CAAAA,QAfyF,2CA8BxG;AA9BwG,uFAexG,6MAE4CnC,CAAAA,KAAK,CAACoC,GAAN,CAAU,oCAAV,CAF5C,uCAEkBC,cAFlB,kBAEYC,IAFZ,CAIIV,cAAc,CAACS,cAAc,CAACE,IAAf,CAAoBZ,WAArB,CAAd,CACAG,uBAAuB,CAAC,CAACjB,eAAD,EAAkB2B,MAAlB,CAAyBH,cAAc,CAACE,IAAf,CAAoBZ,WAA7C,CAAD,CAAvB,CACAK,qBAAqB,CAAC,CAACnB,eAAD,EAAkB2B,MAAlB,CAAyBH,cAAc,CAACE,IAAf,CAAoBZ,WAA7C,EAA0D,CAA1D,CAAD,CAArB,CAEAc,UAAU,CAAC,iBAAMhB,CAAAA,cAAc,CAAC,KAAD,CAApB,EAAD,CAA8B,GAA9B,CAAV,CARJ,iFAWIpB,MAAM,aAAN,CAXJ,qEAfwG,2CA+BxGJ,SAAS,CAAC,UAAM,CACdkC,QAAQ,GACT,CAFQ,CAEN,EAFM,CAAT,CAIA;AACA,QAASO,CAAAA,aAAT,EAAyB,CAEvB,GAAI,CAACT,gBAAgB,CAACN,WAAlB,EAAiC,CAACM,gBAAtC,CAAwD,OAExD,GAAMU,CAAAA,kBAAkB,8BACnBV,gBAAgB,CAACN,WADE,GAEtBI,kBAFsB,EAAxB,CAKAG,mBAAmB,gCACdD,gBADc,MAEjBN,WAAW,CAAEgB,kBAFI,GAAnB,CAKA,GAAIC,CAAAA,qBAAqB,oBAAOf,oBAAP,CAAzB,CAEAe,qBAAqB,CAAGA,qBAAqB,CAACC,MAAtB,CAA6B,SAACC,WAAD,CAAiB,CAEpE,MAAOH,CAAAA,kBAAkB,CAACI,SAAnB,CAA6B,SAACC,UAAD,CAAgB,CAClD,MAAOA,CAAAA,UAAU,CAACjC,IAAX,GAAoB+B,WAAW,CAAC/B,IAAvC,CACD,CAFM,IAEA,CAAC,CAFR,CAGD,CALuB,CAAxB,CAOAe,uBAAuB,oBAClBc,qBADkB,EAAvB,CAIAZ,qBAAqB,CAACnB,eAAD,CAArB,CAEAY,cAAc,CAAC,IAAD,CAAd,CACD,CAED;AACA,QAASwB,CAAAA,gBAAT,CAA0BC,CAA1B,CAAqC,CAEnC,GAAIC,CAAAA,qBAAqB,oBAAOlB,gBAAgB,CAACN,WAAxB,CAAzB,CAEA,GAAIyB,CAAAA,WAAW,CAAGD,qBAAqB,CAACD,CAAD,CAAvC,CAEAC,qBAAqB,CAACE,MAAtB,CAA6BH,CAA7B,CAAgC,CAAhC,EAEAhB,mBAAmB,gCACdD,gBADc,MAEjBN,WAAW,CAAEwB,qBAFI,GAAnB,CAKArB,uBAAuB,8BAClBD,oBADkB,GAErBuB,WAFqB,GAAvB,CAKA3B,cAAc,CAAC,IAAD,CAAd,CACD,CAEDxB,SAAS,CAAC,iBAAMwB,CAAAA,cAAc,CAAC,IAAD,CAApB,EAAD,CAA6B,CACpCQ,gBADoC,CAA7B,CAAT,CAIA;AACA,mBAAQ,yBACL,kBACC,aAAK,SAAS,CAAC,2CAAf,wBAGE,aAAK,SAAS,CAAC,SAAf,wBACE,MAAC,QAAD,EAAU,MAAM,CAAEP,OAAO,CAAC4B,MAA1B,CAAkC,SAAS,CAAC,0BAA5C,CAAuE,SAAS,CAAE1C,UAAU,CAAC,CAAC2C,OAAO,CAAE7B,OAAO,CAAC8B,KAAR,CAAczC,IAAd,GAAuB,0BAAjC,CAAD,CAA5F,wBACE,KAAC,IAAD,EAAM,IAAI,CAAC,SAAX,EADF,cAEE,uCAFF,GADF,cAME,MAAC,QAAD,EAAU,MAAM,CAAEW,OAAO,CAAC4B,MAA1B,CAAkC,SAAS,CAAC,yBAA5C,CAAsE,SAAS,CAAE1C,UAAU,CAAC,CAAC2C,OAAO,CAAE7B,OAAO,CAAC8B,KAAR,CAAczC,IAAd,GAAuB,yBAAjC,CAAD,CAA3F,wBACE,KAAC,IAAD,EAAM,IAAI,CAAC,QAAX,EADF,cAEE,qCAFF,GANF,cAWE,MAAC,QAAD,EAAU,MAAM,CAAEW,OAAO,CAAC4B,MAA1B,CAAkC,SAAS,CAAC,oBAA5C,CAAiE,SAAS,CAAE1C,UAAU,CAAC,CAAC2C,OAAO,CAAE7B,OAAO,CAAC8B,KAAR,CAAczC,IAAd,GAAuB,oBAAjC,CAAD,CAAtF,wBACE,KAAC,IAAD,EAAM,IAAI,CAAC,SAAX,EADF,cAEE,gCAFF,GAXF,cAgBE,MAAC,QAAD,EAAU,MAAM,CAAEW,OAAO,CAAC4B,MAA1B,CAAkC,SAAS,CAAC,uBAA5C,CAAoE,SAAS,CAAE1C,UAAU,CAAC,CAAC2C,OAAO,CAAE7B,OAAO,CAAC8B,KAAR,CAAczC,IAAd,GAAuB,uBAAjC,CAAD,CAAzF,wBACE,KAAC,IAAD,EAAM,IAAI,CAAC,SAAX,EADF,cAEE,oCAFF,GAhBF,cAqBE,MAAC,QAAD,EAAU,MAAM,CAAEW,OAAO,CAAC4B,MAA1B,CAAkC,SAAS,CAAC,sBAA5C,CAAmE,SAAS,CAAE1C,UAAU,CAAC,CAAC2C,OAAO,CAAE7B,OAAO,CAAC8B,KAAR,CAAczC,IAAd,GAAuB,sBAAjC,CAAD,CAAxF,wBACE,KAAC,IAAD,EAAM,IAAI,CAAC,QAAX,EADF,cAEE,kCAFF,GArBF,GAHF,cA8BE,YAAK,SAAS,CAAC,2BAAf,uBACE,sCADF,EA9BF,cAkCE,aAAK,SAAS,CAAC,UAAf,wBAEE,YAAK,SAAS,CAAC,QAAf,kBAFF,cAIE,YAAK,SAAS,CAAC,QAAf,uBAEE,YAAK,SAAS,CAAC,QAAf,uBACE,aAAK,SAAS,CAAC,OAAf,wBACE,+BADF,cAEE,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,2BAAW0C,CAAAA,KAAX,MAAEC,MAAF,CAAWD,KAAX,OAAuBvB,CAAAA,mBAAmB,gCAAKD,gBAAL,MAAuBlB,IAAI,CAAE0C,KAA7B,GAA1C,EAA7B,EAFF,GADF,EAFF,EAJF,GAlCF,cAiDE,aAAK,SAAS,CAAC,UAAf,wBAEE,aAAK,SAAS,CAAC,wBAAf,wBACE,YAAK,SAAS,CAAC,QAAf,yBADF,cAGE,aAAK,SAAS,CAAC,uBAAf,wBACE,sCADF,cAEE,aAAK,SAAS,CAAC,eAAf,wBACE,KAAC,MAAD,EAAQ,OAAO,CAAE5B,oBAAoB,CAAC8B,GAArB,CAAyB,SAACX,UAAD,QAAiB,CACzDY,IAAI,CAAEZ,UAAU,CAACjC,IADwC,CAEzD0C,KAAK,CAAET,UAAU,CAACjC,IAFuC,CAAjB,EAAzB,CAAjB,CAGK,cAAc,CAAEgB,kBAAkB,CAAChB,IAHxC,CAG8C,QAAQ,CAAE,kBAAC0C,KAAD,QAAWzB,CAAAA,qBAAqB,CAACH,oBAAoB,CAACgC,IAArB,CAA0B,SAACT,WAAD,QAAiBA,CAAAA,WAAW,CAACrC,IAAZ,GAAqB0C,KAAtC,EAA1B,CAAD,CAAhC,EAHxD,EADF,cAKE,eAAQ,QAAQ,CAAE,CAAC1B,kBAAkB,CAAChB,IAAtC,CAA4C,SAAS,CAAC,QAAtD,CAA+D,OAAO,CAAE,yBAAM2B,CAAAA,aAAa,EAAnB,EAAxE,iBALF,GAFF,GAHF,GAFF,cAmBE,eAAO,SAAS,CAAE9B,UAAU,CAAC,OAAD,CAAU,kBAAV,CAA8B,CACxDkD,mBAAmB,CAAEvC,KAAK,CAACwC,KAAN,CAAYC,SAAZ,CAAsBC,EADa,CAA9B,CAA5B,wBAGE,mCACE,4BADF,cAEE,4BAFF,cAGE,6BAHF,cAIE,6BAJF,cAKE,iCALF,cAME,8BANF,cAOE,aAPF,GAHF,CAYIhC,gBAAgB,CAACN,WAAlB,CAA0DgC,GAA1D,CAA8D,SAACX,UAAD,CAAaE,CAAb,qBAC7D,mCACE,oBAAKF,UAAU,CAACjC,IAAhB,EADF,cAEE,oBAAKiC,UAAU,CAAChC,IAAhB,EAFF,cAGE,oBAAKgC,UAAU,CAAC/B,KAAhB,EAHF,cAIE,iCACE,KAAC,QAAD,EAAU,QAAQ,CAAE,EAApB,CAAwB,KAAK,CAAE+B,UAAU,CAAC9B,QAA1C,EADF,EAJF,cAOE,iCACE,KAAC,QAAD,EAAU,QAAQ,CAAE,EAApB,CAAwB,KAAK,CAAE8B,UAAU,CAAC7B,YAA1C,EADF,EAPF,cAUE,WAAI,SAAS,CAAEP,UAAU,CAAC,CACxB,WAAYoC,UAAU,CAAC5B,MAAX,GAAsB,KADV,CAExB,aAAc4B,UAAU,CAAC5B,MAAX,GAAsB,IAFZ,CAAD,CAAzB,UAGK4B,UAAU,CAAC5B,MAHhB,EAVF,cAcE,iCACE,eAAQ,SAAS,CAAC,sBAAlB,CAAyC,OAAO,CAAE,yBAAM6B,CAAAA,gBAAgB,CAACC,CAAD,CAAtB,EAAlD,uBACE,KAAC,IAAD,EAAM,IAAI,CAAC,UAAX,EADF,EADF,EAdF,GAASA,CAAT,CAD6D,EAA9D,CAZH,GAnBF,cAuDE,YAAK,SAAS,CAAEtC,UAAU,CAAC,cAAD,CAAiB,kBAAjB,CAAqC,CAC7DkD,mBAAmB,CAAEvC,KAAK,CAACwC,KAAN,CAAYC,SAAZ,CAAsBC,EADkB,CAArC,CAA1B,uBAIE,YAAK,SAAS,CAAC,oBAAf,UAEGhC,gBAAgB,CAACN,WAAjB,CAA6BgC,GAA7B,CAAiC,SAACX,UAAD,CAAaE,CAAb,qBAClC,aAAK,SAAS,CAAC,MAAf,CAA8B,OAAO,CAAE,yBAAMxB,CAAAA,OAAO,CAAC4B,MAAR,CAAeY,QAAf,CAAwB,8BAAxB,CAAwD,EAAxD,CAA4D,CAACC,MAAM,CAAE,IAAT,CAA5D,CAAN,EAAvC,wBAEE,aAAK,SAAS,CAAC,OAAf,wBAEE,aAAK,SAAS,CAAC,QAAf,wBACE,kCAAK,mBAAInB,UAAU,CAACjC,IAAf,EAAL,EADF,cAEE,qBACGiC,UAAU,CAAChC,IADd,EAFF,GAFF,cASE,aAAK,SAAS,CAAC,eAAf,wBACE,YAAK,SAAS,CAAEJ,UAAU,CAAC,CACzB,WAAYoC,UAAU,CAAC5B,MAAX,GAAsB,UADT,CAEzB,aAAc4B,UAAU,CAAC5B,MAAX,GAAsB,QAFX,CAAD,CAA1B,UAIG4B,UAAU,CAAC5B,MAJd,EADF,cAOE,qBACG4B,UAAU,CAAC/B,KADd,EAPF,GATF,GAFF,cAwBE,aAAK,SAAS,CAAC,UAAf,wBAEE,aAAK,SAAS,CAAC,QAAf,wBACE,aAAK,SAAS,CAAC,gBAAf,wBACE,aAAM,SAAS,CAAC,MAAhB,oBADF,cAEE,yCAAO,KAAC,QAAD,EAAU,QAAQ,CAAC,EAAnB,CAAsB,KAAK,CAAE+B,UAAU,CAAC9B,QAAxC,EAAP,GAFF,GADF,cAKE,aAAK,SAAS,CAAC,gBAAf,wBACE,aAAM,SAAS,CAAC,MAAhB,wBADF,cAEE,yCAAO,KAAC,QAAD,EAAU,QAAQ,CAAC,EAAnB,CAAsB,KAAK,CAAE8B,UAAU,CAAC7B,YAAxC,EAAP,GAFF,GALF,GAFF,cAaE,YAAK,SAAS,CAAC,eAAf,uBACE,kCACI,eAAQ,SAAS,CAAC,sBAAlB,CAAyC,OAAO,CAAE,iBAACiD,CAAD,CAAO,CAAEA,CAAC,CAACC,eAAF,GAAqBpB,gBAAgB,CAACC,CAAD,CAAhB,CAAqB,CAArG,uBACA,KAAC,IAAD,EAAM,IAAI,CAAC,UAAX,EADA,EADJ,EADF,EAbF,GAxBF,GAA2BA,CAA3B,CADkC,EAAjC,CAFH,EAJF,EAvDF,GAjDF,cAkKE,aAAK,SAAS,CAAC,2CAAf,wBACE,cADF,cAEE,aAAK,SAAS,CAAC,SAAf,wBACE,eAAQ,SAAS,CAAC,gBAAlB,CAAmC,OAAO,CAAE,yBAAMxB,CAAAA,OAAO,CAAC4B,MAAR,CAAeY,QAAf,CAAwB,oBAAxB,CAA8C,EAA9C,CAAkD,CAClGC,MAAM,CAAE,IAD0F,CAAlD,CAAN,EAA5C,oBADF,cAME,eAAQ,QAAQ,CAAE,CAAC3C,WAAnB,CAAgC,SAAS,CAAC,kBAA1C,kBANF,GAFF,GAlKF,GADD,CAiLG,IAlLE,EAAR,CAoLD,CAnRqC,CAAtC,CAoRA,cAAeF,CAAAA,6BAAf","sourcesContent":["import axios from \"axios\"\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport Icon from \"../../../components/Icon\"\nimport { nError } from \"../../../funcs\"\nimport { StoreDispatch, StoreState, mapDispatchToProps, mapStateToProps } from \"../../../store\";\n\nimport \"../../../styles/pages/common/entity-edit.sass\"\nimport Select from \"../../../components/Select\"\nimport Checkbox from \"../../../components/Checkbox\"\nimport { BaseLink, useRoute } from \"react-router5\"\nimport { CallCenter_Dispatcher } from \"../../../models/CallCenter\"\nimport classNames from \"classnames\"\n\ninterface Props {\n  store: StoreState,\n  dispatcher: StoreDispatch\n}\n\nconst emptyDispatcher: CallCenter_Dispatcher = {\n  dispatcher_id: '',\n  name: '',\n  user: '',\n  phone: '',\n  is_phone: false,\n  is_softphone: false,\n  active: 'Active',\n  groups: '',\n  \"created_at\": \"05/04/2021 09:32am\",\n  \"created_by\": \"Alex\",\n  \"last_edited_at\": \"05/04/2021 10:34am\",\n  \"last_edited_by\": \"Alex\"\n}\n\nconst CallCenter_CallGroupsPage_New = connect(mapStateToProps, mapDispatchToProps)(function(props: Props) {\n\n  const [readyToSave, setReadyToSave] = useState(false)\n\n  const $router = useRoute()\n\n  const [dispatchers, setDispatchers] = useState<CallCenter_Dispatcher[] | null>(null)\n  const [availableDispatchers, setAvailableDispatchers] = useState<CallCenter_Dispatcher[]>([])\n  const [selectedDispatcher, setSelectedDispatcher] = useState<CallCenter_Dispatcher>(emptyDispatcher)\n  const [newCallGroupData, setNewCallGroupData] = useState({\n    name: '',\n    dispatchers: [] as CallCenter_Dispatcher[]\n  })\n  \n  // Load info function\n  async function loadInfo() {\n    try {\n      const { data: callGroupsData } = (await axios.get('/json/call_center_call_groups.json'))\n\n      setDispatchers(callGroupsData.edit.dispatchers)\n      setAvailableDispatchers([emptyDispatcher].concat(callGroupsData.edit.dispatchers))\n      setSelectedDispatcher([emptyDispatcher].concat(callGroupsData.edit.dispatchers)[0])\n\n      setTimeout(() => setReadyToSave(false), 100)\n    }\n    catch (error) {\n      nError(error)\n    }\n  }\n\n  // Load callGroup data\n  useEffect(() => {\n    loadInfo()\n  }, [])\n\n  // Add dispatcher function\n  function addDispatcher() {\n\n    if (!newCallGroupData.dispatchers || !newCallGroupData) return\n\n    const newDispatchersList = [\n      ...newCallGroupData.dispatchers,\n      selectedDispatcher\n    ]\n\n    setNewCallGroupData({\n      ...newCallGroupData,\n      dispatchers: newDispatchersList\n    })\n\n    let _availableDispatchers = [...availableDispatchers]\n\n    _availableDispatchers = _availableDispatchers.filter(($dispatcher) => {\n      \n      return newDispatchersList.findIndex((dispatcher) => {\n        return dispatcher.name === $dispatcher.name\n      }) === -1\n    })\n\n    setAvailableDispatchers([\n      ..._availableDispatchers\n    ])\n\n    setSelectedDispatcher(emptyDispatcher)\n\n    setReadyToSave(true)\n  }\n\n  // Remove dispatcher function\n  function removeDispatcher(i: number) {\n\n    let _callGroupDispatchers = [...newCallGroupData.dispatchers]\n\n    let _dispatcher = _callGroupDispatchers[i]\n    \n    _callGroupDispatchers.splice(i, 1)\n\n    setNewCallGroupData({\n      ...newCallGroupData,\n      dispatchers: _callGroupDispatchers\n    })\n\n    setAvailableDispatchers([\n      ...availableDispatchers,\n      _dispatcher\n    ])\n\n    setReadyToSave(true)\n  }\n\n  useEffect(() => setReadyToSave(true), [\n    newCallGroupData\n  ])\n  \n  // Render function\n  return (<>\n    {true ? (\n      <div className=\"CallCenter_CallGroupsPage_New entity-edit\">\n\n        {/* Top navigation */}\n        <div className=\"top-nav\">\n          <BaseLink router={$router.router} routeName=\"call_center.phoneNumbers\" className={classNames({_active: $router.route.name === \"call_center.phoneNumbers\"})}>\n            <Icon icon=\"phone-1\" />\n            <span>Phone Numbers</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.dispatchers\" className={classNames({_active: $router.route.name === \"call_center.dispatchers\"})}>\n            <Icon icon=\"user-1\" />\n            <span>Dispatchers</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.groups\" className={classNames({_active: $router.route.name === \"call_center.groups\"})}>\n            <Icon icon=\"user-29\" />\n            <span>Groups</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.callFlows\" className={classNames({_active: $router.route.name === \"call_center.callFlows\"})}>\n            <Icon icon=\"share-7\" />\n            <span>Call Flows</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.settings\" className={classNames({_active: $router.route.name === \"call_center.settings\"})}>\n            <Icon icon=\"gear-1\" />\n            <span>Settings</span>\n          </BaseLink>\n        </div>\n\n        <div className=\"wrapper flex-container sb\">\n          <h1>New Call Group</h1>\n        </div>\n        \n        <div className=\"fieldset\">\n          \n          <div className=\"legend\">Main</div>\n\n          <div className=\"fields\">\n\n            <div className=\"__left\">\n              <div className=\"field\">\n                <span>Name:</span>\n                <input type=\"text\" onChange={({target: {value}}) => setNewCallGroupData({...newCallGroupData, name: value})} />\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"fieldset\">\n\n          <div className=\"flex-container sb wrap\">\n            <div className=\"legend\">Dispatchers</div>\n\n            <div className=\"legend-action-wrapper\">\n              <label>Dispatcher:</label>\n              <div className=\"input-wrapper\">\n                <Select options={availableDispatchers.map((dispatcher) => ({\n                  span: dispatcher.name,\n                  value: dispatcher.name\n                }))} selectedOption={selectedDispatcher.name} onChange={(value) => setSelectedDispatcher(availableDispatchers.find((_dispatcher) => _dispatcher.name === value) as CallCenter_Dispatcher)}/>\n                <button disabled={!selectedDispatcher.name} className=\"_green\" onClick={() => addDispatcher()}>\n                  Add\n                </button>\n              </div>\n            </div>\n          </div>\n\n          <table className={classNames('table', '__hide-on-mobile', {\n            __respectAsidePanel: props.store.navActive.is\n          })}>\n            <tr>\n              <th>Name</th>\n              <th>User</th>\n              <th>Phone</th>\n              <th>Phone</th>\n              <th>Softphone</th>\n              <th>Active</th>\n              <th></th>\n            </tr>\n            {(newCallGroupData.dispatchers as CallCenter_Dispatcher[]).map((dispatcher, i) => (\n              <tr key={i}>\n                <td>{dispatcher.name}</td>\n                <td>{dispatcher.user}</td>\n                <td>{dispatcher.phone}</td>\n                <td>\n                  <Checkbox contents={''} value={dispatcher.is_phone} />\n                </td>\n                <td>\n                  <Checkbox contents={''} value={dispatcher.is_softphone} />\n                </td>\n                <td className={classNames({\n                  'red-text': dispatcher.active === 'Off',\n                  'green-text': dispatcher.active === 'On',\n                })}>{dispatcher.active}</td>\n                <td>\n                  <button className=\"_zeroed _iconed _red\" onClick={() => removeDispatcher(i)}>\n                    <Icon icon=\"x-mark-1\" />\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </table>\n\n          <div className={classNames('mobile-table', '__show-on-mobile', {\n            __respectAsidePanel: props.store.navActive.is\n          })}>\n\n            <div className=\"mobile-table-items\">\n\n              {newCallGroupData.dispatchers.map((dispatcher, i: number) => (\n              <div className=\"item\" key={i} onClick={() => $router.router.navigate('call_center.dispatchers.item', {}, {reload: true})}>\n\n                <div className=\"__top\">\n\n                  <div className=\"__left\">\n                    <div><b>{dispatcher.name}</b></div>\n                    <div>\n                      {dispatcher.user}\n                    </div>\n                  </div>\n\n                  <div className=\"__right small\">\n                    <div className={classNames({\n                      'red-text': dispatcher.active === 'Inactive',\n                      'green-text': dispatcher.active === 'Active',\n                    })}>\n                      {dispatcher.active}\n                    </div>\n                    <div>\n                      {dispatcher.phone}\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"__bottom\">\n\n                  <div className=\"__left\">\n                    <div className=\"flex-container\">\n                      <span className=\"gray\">Phone:</span>\n                      <span> <Checkbox contents='' value={dispatcher.is_phone} /></span>\n                    </div>\n                    <div className=\"flex-container\">\n                      <span className=\"gray\">Softphone:</span>\n                      <span> <Checkbox contents='' value={dispatcher.is_softphone} /></span>\n                    </div>\n                  </div>\n\n                  <div className=\"__right small\">\n                    <div>\n                        <button className=\"_zeroed _iconed _red\" onClick={(e) => { e.stopPropagation(); removeDispatcher(i) }}>\n                        <Icon icon=\"x-mark-1\" />\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"wrapper flex-container sb editing-buttons\">\n          <div />\n          <div className=\"buttons\">\n            <button className=\"_bordered _red\" onClick={() => $router.router.navigate('call_center.groups', {}, {\n              reload: true\n            })}>\n              Cancel\n            </button>\n            <button disabled={!readyToSave} className=\"_bordered _green\">\n              Save\n            </button>\n          </div>\n        </div>\n      </div>\n    ) : null}\n  </>)\n})\nexport default CallCenter_CallGroupsPage_New\n"]},"metadata":{},"sourceType":"module"}