{"ast":null,"code":"import _objectSpread from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/regenerator/index.js\";import axios from\"axios\";import React,{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import Icon from\"../../components/Icon\";import{nError}from\"../../funcs\";import{mapDispatchToProps,mapStateToProps}from\"../../store\";import\"../../styles/pages/common/entity-edit.sass\";import Select from\"../../components/Select\";import{useRoute}from\"react-router5\";import Switcher from\"../../components/Switcher\";import ReactCrop from\"react-image-crop\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UsersPage_New=connect(mapStateToProps,mapDispatchToProps)(function(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),readyToSave=_useState2[0],setReadyToSave=_useState2[1];var $router=useRoute();var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),avatarPopup=_useState4[0],setAvatarPopup=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),avatarImageSrc=_useState6[0],setAvatarImageSrc=_useState6[1];var _useState7=useState({unit:'%',width:30,aspect:1}),_useState8=_slicedToArray(_useState7,2),avatarCrop=_useState8[0],setAvatarCrop=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),editions=_useState10[0],setEditions=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),newUserData=_useState12[0],setNewUserData=_useState12[1];console.log('user.new');// Load info function\nfunction loadInfo(){return _loadInfo.apply(this,arguments);}// Load user data\nfunction _loadInfo(){_loadInfo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,usersData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('/json/users.json');case 3:_yield$axios$get=_context.sent;usersData=_yield$axios$get.data;setEditions(usersData.edit);setNewUserData({firstname:'',lastname:'',function:'',phone:'',street:'',unit:'',city:'',zip:'',time_zone:usersData.edit.time_zone[0],permission:usersData.edit.permissions[0],State:usersData.edit.state[0],active_status:''});setTimeout(function(){return setReadyToSave(false);},100);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);nError(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return _loadInfo.apply(this,arguments);}useEffect(function(){loadInfo();},[]);// On select file function\nfunction onSelectFile(e){if(e.target.files&&e.target.files.length>0){var reader=new FileReader();reader.addEventListener('load',function(){return setAvatarImageSrc(reader.result);});reader.readAsDataURL(e.target.files[0]);}}useEffect(function(){return setReadyToSave(true);},[newUserData]);// Render function\nreturn/*#__PURE__*/_jsx(_Fragment,{children:editions&&newUserData.time_zone?/*#__PURE__*/_jsxs(\"div\",{className:\"UsersPage_New entity-edit\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"wrapper flex-container sb\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"New user\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"fieldset\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend\",children:\"Main\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"fields\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"First Name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(_ref){var value=_ref.target.value;return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{firstname:value}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Last Name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(_ref2){var value=_ref2.target.value;return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{lastname:value}));}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"__right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Active:\"}),/*#__PURE__*/_jsx(Switcher,{checked:newUserData.active_status==='Active',onChange:function onChange(value){return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{active_status:value?'Active':'Inactive'}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Email:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(_ref3){var value=_ref3.target.value;return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{email:value}));}})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"avatar-editing\",children:/*#__PURE__*/_jsx(\"button\",{className:\"_zeroed _iconed\",onClick:function onClick(){return setAvatarPopup(true);},children:/*#__PURE__*/_jsx(Icon,{icon:\"user-20\"})})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fieldset\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend\",children:\"Settings\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"fields\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Function:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(_ref4){var value=_ref4.target.value;return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{function:value}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Phone:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(_ref5){var value=_ref5.target.value;return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{phone:value}));}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"__right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",style:{zIndex:7},children:[/*#__PURE__*/_jsx(\"span\",{children:\"Time Zone:\"}),/*#__PURE__*/_jsx(Select,{options:editions.time_zone.map(function(option){return{span:option,value:option};}),selectedOption:newUserData.time_zone,onChange:function onChange(value){return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{time_zone:value}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Permission:\"}),/*#__PURE__*/_jsx(Select,{options:editions.permissions.map(function(option){return{span:option,value:option};}),selectedOption:newUserData.permission,onChange:function onChange(value){return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{permission:value}));}})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fieldset\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend\",children:\"Address\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"fields\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Street:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(_ref6){var value=_ref6.target.value;return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{street:value}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Unit/Apt:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(_ref7){var value=_ref7.target.value;return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{unit:value}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"City:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(_ref8){var value=_ref8.target.value;return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{city:value}));}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"__right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"State:\"}),/*#__PURE__*/_jsx(Select,{options:editions.state.map(function(option){return{span:option,value:option};}),selectedOption:newUserData.State,onChange:function onChange(value){return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{State:value}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Zip:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(_ref9){var value=_ref9.target.value;return setNewUserData(_objectSpread(_objectSpread({},newUserData),{},{zip:value}));}})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper flex-container sb editing-buttons\",children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"_bordered _red\",onClick:function onClick(){return $router.router.navigate('users',{},{reload:true});},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{disabled:!readyToSave,className:\"_bordered _green\",children:\"Save\"})]})]}),avatarPopup?/*#__PURE__*/_jsx(\"div\",{className:\"popup imageCrop\",onClick:function onClick(){return setAvatarPopup(false);},children:/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper\",onClick:function onClick(e){return e.stopPropagation();},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:onSelectFile,id:\"file-uploader\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"_wa _iconed _bordered _blue\",onClick:function onClick(){var _document$getElementB;return(_document$getElementB=document.getElementById('file-uploader'))===null||_document$getElementB===void 0?void 0:_document$getElementB.click();},children:[/*#__PURE__*/_jsx(Icon,{icon:\"user-33\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Upload a File\"})]})]}),/*#__PURE__*/_jsx(\"div\",{children:avatarImageSrc&&/*#__PURE__*/_jsx(ReactCrop,{src:avatarImageSrc,crop:avatarCrop,onChange:function onChange(value){return setAvatarCrop(value);}})})]})}):null]}):null});});export default UsersPage_New;","map":{"version":3,"sources":["/Users/nicole/rrrr/crm/src/pages/Users/New.tsx"],"names":["axios","React","useEffect","useState","connect","Icon","nError","mapDispatchToProps","mapStateToProps","Select","useRoute","Switcher","ReactCrop","UsersPage_New","props","readyToSave","setReadyToSave","$router","avatarPopup","setAvatarPopup","avatarImageSrc","setAvatarImageSrc","unit","width","aspect","avatarCrop","setAvatarCrop","editions","setEditions","newUserData","setNewUserData","console","log","loadInfo","get","usersData","data","edit","firstname","lastname","function","phone","street","city","zip","time_zone","permission","permissions","State","state","active_status","setTimeout","onSelectFile","e","target","files","length","reader","FileReader","addEventListener","result","readAsDataURL","value","email","zIndex","map","option","span","router","navigate","reload","stopPropagation","document","getElementById","click"],"mappings":"kbAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,OAAT,KAAwB,aAAxB,CACA,MAAOC,CAAAA,IAAP,KAAiB,uBAAjB,CACA,OAASC,MAAT,KAAuB,aAAvB,CAEA,OAAoCC,kBAApC,CAAwDC,eAAxD,KAA+E,aAA/E,CAGA,MAAO,4CAAP,CAEA,MAAOC,CAAAA,MAAP,KAAmB,yBAAnB,CAEA,OAASC,QAAT,KAAyB,eAAzB,CACA,MAAOC,CAAAA,QAAP,KAAqB,2BAArB,CACA,MAAOC,CAAAA,SAAP,KAAgC,kBAAhC,C,6IAQA,GAAMC,CAAAA,aAAa,CAAGT,OAAO,CAACI,eAAD,CAAkBD,kBAAlB,CAAP,CAA6C,SAASO,KAAT,CAAuB,CAExF,cAAsCX,QAAQ,CAAC,KAAD,CAA9C,wCAAOY,WAAP,eAAoBC,cAApB,eAEA,GAAMC,CAAAA,OAAO,CAAGP,QAAQ,EAAxB,CAEA,eAAsCP,QAAQ,CAAC,KAAD,CAA9C,yCAAOe,WAAP,eAAoBC,cAApB,eACA,eAA4ChB,QAAQ,CAAC,EAAD,CAApD,yCAAOiB,cAAP,eAAuBC,iBAAvB,eACA,eAAoClB,QAAQ,CAAgB,CAC1DmB,IAAI,CAAE,GADoD,CAE1DC,KAAK,CAAE,EAFmD,CAG1DC,MAAM,CAAE,CAHkD,CAAhB,CAA5C,yCAAOC,UAAP,eAAmBC,aAAnB,eAMA,eAAgCvB,QAAQ,CAI9B,IAJ8B,CAAxC,0CAAOwB,QAAP,gBAAiBC,WAAjB,gBAMA,gBAAsCzB,QAAQ,CAAsB,EAAtB,CAA9C,2CAAO0B,WAAP,gBAAoBC,cAApB,gBAGAC,OAAO,CAACC,GAAR,CAAY,UAAZ,EACA;AAxBwF,QAyBzEC,CAAAA,QAzByE,2CAoDxF;AApDwF,uFAyBxF,wMAEuCjC,CAAAA,KAAK,CAACkC,GAAN,CAAU,kBAAV,CAFvC,uCAEkBC,SAFlB,kBAEYC,IAFZ,CAIIR,WAAW,CAACO,SAAS,CAACE,IAAX,CAAX,CACAP,cAAc,CAAC,CACbQ,SAAS,CAAE,EADE,CAEbC,QAAQ,CAAE,EAFG,CAGbC,QAAQ,CAAE,EAHG,CAIbC,KAAK,CAAE,EAJM,CAKbC,MAAM,CAAE,EALK,CAMbpB,IAAI,CAAE,EANO,CAObqB,IAAI,CAAE,EAPO,CAQbC,GAAG,CAAE,EARQ,CASbC,SAAS,CAAEV,SAAS,CAACE,IAAV,CAAeQ,SAAf,CAAyB,CAAzB,CATE,CAUbC,UAAU,CAAEX,SAAS,CAACE,IAAV,CAAeU,WAAf,CAA2B,CAA3B,CAVC,CAWbC,KAAK,CAAEb,SAAS,CAACE,IAAV,CAAeY,KAAf,CAAqB,CAArB,CAXM,CAYbC,aAAa,CAAE,EAZF,CAAD,CAAd,CAeAC,UAAU,CAAC,iBAAMnC,CAAAA,cAAc,CAAC,KAAD,CAApB,EAAD,CAA8B,GAA9B,CAAV,CApBJ,iFAuBIV,MAAM,aAAN,CAvBJ,qEAzBwF,2CAqDxFJ,SAAS,CAAC,UAAM,CACd+B,QAAQ,GACT,CAFQ,CAEN,EAFM,CAAT,CAIA;AACA,QAASmB,CAAAA,YAAT,CAAsBC,CAAtB,CAA8B,CAC5B,GAAIA,CAAC,CAACC,MAAF,CAASC,KAAT,EAAkBF,CAAC,CAACC,MAAF,CAASC,KAAT,CAAeC,MAAf,CAAwB,CAA9C,CAAiD,CAC/C,GAAMC,CAAAA,MAAM,CAAG,GAAIC,CAAAA,UAAJ,EAAf,CACAD,MAAM,CAACE,gBAAP,CAAwB,MAAxB,CAAgC,iBAC9BtC,CAAAA,iBAAiB,CAACoC,MAAM,CAACG,MAAR,CADa,EAAhC,EAGAH,MAAM,CAACI,aAAP,CAAqBR,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAArB,EACD,CACF,CAEDrD,SAAS,CAAC,iBAAMc,CAAAA,cAAc,CAAC,IAAD,CAApB,EAAD,CAA6B,CACpCa,WADoC,CAA7B,CAAT,CAIA;AACA,mBAAQ,yBACLF,QAAQ,EAAIE,WAAW,CAACgB,SAAxB,cACC,aAAK,SAAS,CAAC,2BAAf,wBAEE,YAAK,SAAS,CAAC,2BAAf,uBACE,gCADF,EAFF,cAME,aAAK,SAAS,CAAC,UAAf,wBAEE,YAAK,SAAS,CAAC,QAAf,kBAFF,cAIE,aAAK,SAAS,CAAC,QAAf,wBAEE,aAAK,SAAS,CAAC,QAAf,wBACE,aAAK,SAAS,CAAC,OAAf,wBACE,qCADF,cAEE,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,2BAAWiB,CAAAA,KAAX,MAAER,MAAF,CAAWQ,KAAX,OAAuBhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBS,SAAS,CAAEwB,KAA7B,GAArC,EAA7B,EAFF,GADF,cAME,aAAK,SAAS,CAAC,OAAf,wBACE,oCADF,cAEE,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,4BAAWA,CAAAA,KAAX,OAAER,MAAF,CAAWQ,KAAX,OAAuBhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBU,QAAQ,CAAEuB,KAA5B,GAArC,EAA7B,EAFF,GANF,GAFF,cAcE,aAAK,SAAS,CAAC,SAAf,wBACE,aAAK,SAAS,CAAC,OAAf,wBACE,iCADF,cAEE,KAAC,QAAD,EAAU,OAAO,CAAEjC,WAAW,CAACqB,aAAZ,GAA8B,QAAjD,CAA2D,QAAQ,CAAE,kBAACY,KAAD,QAAWhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBqB,aAAa,CAAEY,KAAK,CAAG,QAAH,CAAc,UAApD,GAAzB,EAArE,EAFF,GADF,cAME,aAAK,SAAS,CAAC,OAAf,wBACE,gCADF,cAEE,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,4BAAWA,CAAAA,KAAX,OAAER,MAAF,CAAWQ,KAAX,OAAuBhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBkC,KAAK,CAAED,KAAzB,GAArC,EAA7B,EAFF,GANF,GAdF,cA0BE,YAAK,SAAS,CAAC,gBAAf,uBACE,eAAQ,SAAS,CAAC,iBAAlB,CAAoC,OAAO,CAAE,yBAAM3C,CAAAA,cAAc,CAAC,IAAD,CAApB,EAA7C,uBACE,KAAC,IAAD,EAAM,IAAI,CAAC,SAAX,EADF,EADF,EA1BF,GAJF,GANF,cA4CE,aAAK,SAAS,CAAC,UAAf,wBAEE,YAAK,SAAS,CAAC,QAAf,sBAFF,cAIE,aAAK,SAAS,CAAC,QAAf,wBAEE,aAAK,SAAS,CAAC,QAAf,wBACE,aAAK,SAAS,CAAC,OAAf,wBACE,mCADF,cAEE,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,4BAAW2C,CAAAA,KAAX,OAAER,MAAF,CAAWQ,KAAX,OAAuBhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBW,QAAQ,CAAEsB,KAA5B,GAArC,EAA7B,EAFF,GADF,cAME,aAAK,SAAS,CAAC,OAAf,wBACE,gCADF,cAEE,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,4BAAWA,CAAAA,KAAX,OAAER,MAAF,CAAWQ,KAAX,OAAuBhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBY,KAAK,CAAEqB,KAAzB,GAArC,EAA7B,EAFF,GANF,GAFF,cAcE,aAAK,SAAS,CAAC,SAAf,wBACE,aAAK,SAAS,CAAC,OAAf,CAAuB,KAAK,CAAE,CAACE,MAAM,CAAE,CAAT,CAA9B,wBACE,oCADF,cAEE,KAAC,MAAD,EAAQ,OAAO,CAAErC,QAAQ,CAACkB,SAAT,CAAmBoB,GAAnB,CAAuB,SAACC,MAAD,QAAa,CACnDC,IAAI,CAAED,MAD6C,CAEnDJ,KAAK,CAAEI,MAF4C,CAAb,EAAvB,CAAjB,CAGK,cAAc,CAAErC,WAAW,CAACgB,SAHjC,CAG4C,QAAQ,CAAE,kBAACiB,KAAD,QAAmBhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBgB,SAAS,CAAEiB,KAA7B,GAAjC,EAHtD,EAFF,GADF,cASE,aAAK,SAAS,CAAC,OAAf,wBACE,qCADF,cAEE,KAAC,MAAD,EAAQ,OAAO,CAAEnC,QAAQ,CAACoB,WAAT,CAAqBkB,GAArB,CAAyB,SAACC,MAAD,QAAa,CACrDC,IAAI,CAAED,MAD+C,CAErDJ,KAAK,CAAEI,MAF8C,CAAb,EAAzB,CAAjB,CAGK,cAAc,CAAErC,WAAW,CAACiB,UAHjC,CAGuD,QAAQ,CAAE,kBAACgB,KAAD,QAAmBhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBiB,UAAU,CAAEgB,KAA9B,GAAjC,EAHjE,EAFF,GATF,GAdF,GAJF,GA5CF,cAkFE,aAAK,SAAS,CAAC,UAAf,wBAEE,YAAK,SAAS,CAAC,QAAf,qBAFF,cAIE,aAAK,SAAS,CAAC,QAAf,wBAEE,aAAK,SAAS,CAAC,QAAf,wBACE,aAAK,SAAS,CAAC,OAAf,wBACE,iCADF,cAEE,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,4BAAWA,CAAAA,KAAX,OAAER,MAAF,CAAWQ,KAAX,OAAuBhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBa,MAAM,CAAEoB,KAA1B,GAArC,EAA7B,EAFF,GADF,cAME,aAAK,SAAS,CAAC,OAAf,wBACE,mCADF,cAEE,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,4BAAWA,CAAAA,KAAX,OAAER,MAAF,CAAWQ,KAAX,OAAuBhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBP,IAAI,CAAEwC,KAAxB,GAArC,EAA7B,EAFF,GANF,cAWE,aAAK,SAAS,CAAC,OAAf,wBACE,+BADF,cAEE,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,4BAAWA,CAAAA,KAAX,OAAER,MAAF,CAAWQ,KAAX,OAAuBhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBc,IAAI,CAAEmB,KAAxB,GAArC,EAA7B,EAFF,GAXF,GAFF,cAmBE,aAAK,SAAS,CAAC,SAAf,wBACE,aAAK,SAAS,CAAC,OAAf,wBACE,gCADF,cAEE,KAAC,MAAD,EAAQ,OAAO,CAAEnC,QAAQ,CAACsB,KAAT,CAAegB,GAAf,CAAmB,SAACC,MAAD,QAAa,CAC/CC,IAAI,CAAED,MADyC,CAE/CJ,KAAK,CAAEI,MAFwC,CAAb,EAAnB,CAAjB,CAGK,cAAc,CAAErC,WAAW,CAACmB,KAHjC,CAGkD,QAAQ,CAAE,kBAACc,KAAD,QAAmBhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBmB,KAAK,CAAEc,KAAzB,GAAjC,EAH5D,EAFF,GADF,cASE,aAAK,SAAS,CAAC,OAAf,wBACE,8BADF,cAEE,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,4BAAWA,CAAAA,KAAX,OAAER,MAAF,CAAWQ,KAAX,OAAuBhC,CAAAA,cAAc,gCAAKD,WAAL,MAAkBe,GAAG,CAAEkB,KAAvB,GAArC,EAA7B,EAFF,GATF,GAnBF,GAJF,GAlFF,cA0HE,aAAK,SAAS,CAAC,2CAAf,wBACE,cADF,cAEE,aAAK,SAAS,CAAC,SAAf,wBACE,eAAQ,SAAS,CAAC,gBAAlB,CAAmC,OAAO,CAAE,yBAAM7C,CAAAA,OAAO,CAACmD,MAAR,CAAeC,QAAf,CAAwB,OAAxB,CAAiC,EAAjC,CAAqC,CACrFC,MAAM,CAAE,IAD6E,CAArC,CAAN,EAA5C,oBADF,cAME,eAAQ,QAAQ,CAAE,CAACvD,WAAnB,CAAgC,SAAS,CAAC,kBAA1C,kBANF,GAFF,GA1HF,CAwIGG,WAAW,cACV,YAAK,SAAS,CAAC,iBAAf,CAAiC,OAAO,CAAE,yBAAMC,CAAAA,cAAc,CAAC,KAAD,CAApB,EAA1C,uBAEE,aAAK,SAAS,CAAC,SAAf,CAAyB,OAAO,CAAE,iBAACkC,CAAD,QAAOA,CAAAA,CAAC,CAACkB,eAAF,EAAP,EAAlC,wBAEE,oCACE,cAAO,IAAI,CAAC,MAAZ,CAAmB,MAAM,CAAC,SAA1B,CAAoC,QAAQ,CAAEnB,YAA9C,CAA4D,EAAE,CAAC,eAA/D,EADF,cAEE,gBAAQ,SAAS,CAAC,6BAAlB,CAAgD,OAAO,CAAE,0EAAMoB,QAAQ,CAACC,cAAT,CAAwB,eAAxB,CAAN,gDAAM,sBAA0CC,KAA1C,EAAN,EAAzD,wBACE,KAAC,IAAD,EAAM,IAAI,CAAC,SAAX,EADF,cAEE,uCAFF,GAFF,GAFF,cAUE,qBACGtD,cAAc,eACb,KAAC,SAAD,EACE,GAAG,CAAEA,cADP,CAEE,IAAI,CAAEK,UAFR,CAGE,QAAQ,CAAE,kBAACqC,KAAD,QAAWpC,CAAAA,aAAa,CAACoC,KAAD,CAAxB,EAHZ,EAFJ,EAVF,GAFF,EADU,CAwBR,IAhKN,GADD,CAmKG,IApKE,EAAR,CAsKD,CA/OqB,CAAtB,CAgPA,cAAejD,CAAAA,aAAf","sourcesContent":["import axios from \"axios\"\nimport React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport Icon from \"../../components/Icon\"\nimport { nError } from \"../../funcs\"\nimport User from \"../../models/User\"\nimport { StoreDispatch, StoreState, mapDispatchToProps, mapStateToProps } from \"../../store\";\nimport Datetime from 'react-datetime'\n\nimport \"../../styles/pages/common/entity-edit.sass\"\nimport moment from \"moment\"\nimport Select from \"../../components/Select\"\nimport Checkbox from \"../../components/Checkbox\"\nimport { useRoute } from \"react-router5\"\nimport Switcher from \"../../components/Switcher\"\nimport ReactCrop, { Crop } from \"react-image-crop\"\nimport UserCustom from \"../../models/UserCustom\"\n\ninterface Props {\n  store: StoreState,\n  dispatcher: StoreDispatch\n}\n\nconst UsersPage_New = connect(mapStateToProps, mapDispatchToProps)(function(props: Props) {\n\n  const [readyToSave, setReadyToSave] = useState(false)\n\n  const $router = useRoute()\n\n  const [avatarPopup, setAvatarPopup] = useState(false)\n  const [avatarImageSrc, setAvatarImageSrc] = useState('')\n  const [avatarCrop, setAvatarCrop] = useState<Partial<Crop>>({\n    unit: '%',\n    width: 30,\n    aspect: 1\n  })\n\n  const [editions, setEditions] = useState<{\n    time_zone: string[],\n    permissions: string[],\n    state: string[]\n  } | null>(null)\n\n  const [newUserData, setNewUserData] = useState<Partial<UserCustom>>({\n    \n  })\n  console.log('user.new')\n  // Load info function\n  async function loadInfo() {\n    try {\n      const { data: usersData } = (await axios.get('/json/users.json'))\n\n      setEditions(usersData.edit)\n      setNewUserData({\n        firstname: '',\n        lastname: '',\n        function: '',\n        phone: '',\n        street: '',\n        unit: '',\n        city: '',\n        zip: '',\n        time_zone: usersData.edit.time_zone[0],\n        permission: usersData.edit.permissions[0],\n        State: usersData.edit.state[0],\n        active_status: ''\n      })\n\n      setTimeout(() => setReadyToSave(false), 100)\n    }\n    catch (error) {\n      nError(error)\n    }\n  }\n\n  // Load user data\n  useEffect(() => {\n    loadInfo()\n  }, [])\n\n  // On select file function\n  function onSelectFile(e: any) {\n    if (e.target.files && e.target.files.length > 0) {\n      const reader = new FileReader();\n      reader.addEventListener('load', () =>\n        setAvatarImageSrc(reader.result as string)\n      );\n      reader.readAsDataURL(e.target.files[0]);\n    }\n  }\n\n  useEffect(() => setReadyToSave(true), [\n    newUserData\n  ])\n  \n  // Render function\n  return (<>\n    {editions && newUserData.time_zone ? (\n      <div className=\"UsersPage_New entity-edit\">\n\n        <div className=\"wrapper flex-container sb\">\n          <h1>New user</h1>\n        </div>\n        \n        <div className=\"fieldset\">\n          \n          <div className=\"legend\">Main</div>\n\n          <div className=\"fields\">\n\n            <div className=\"__left\">\n              <div className=\"field\">\n                <span>First Name:</span>\n                <input type=\"text\" onChange={({target: {value}}) => setNewUserData({...newUserData, firstname: value})} />\n              </div>\n\n              <div className=\"field\">\n                <span>Last Name:</span>\n                <input type=\"text\" onChange={({target: {value}}) => setNewUserData({...newUserData, lastname: value})} />\n              </div>\n            </div>\n\n            <div className=\"__right\">\n              <div className=\"field\">\n                <span>Active:</span>\n                <Switcher checked={newUserData.active_status === 'Active'} onChange={(value) => setNewUserData({...newUserData, active_status: value ? 'Active' : 'Inactive'})} />\n              </div>\n\n              <div className=\"field\">\n                <span>Email:</span>\n                <input type=\"text\" onChange={({target: {value}}) => setNewUserData({...newUserData, email: value})} />\n              </div>\n            </div>\n\n            <div className=\"avatar-editing\">\n              <button className=\"_zeroed _iconed\" onClick={() => setAvatarPopup(true)}>\n                <Icon icon=\"user-20\" />\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"fieldset\">\n          \n          <div className=\"legend\">Settings</div>\n\n          <div className=\"fields\">\n\n            <div className=\"__left\">\n              <div className=\"field\">\n                <span>Function:</span>\n                <input type=\"text\" onChange={({target: {value}}) => setNewUserData({...newUserData, function: value})} />\n              </div>\n\n              <div className=\"field\">\n                <span>Phone:</span>\n                <input type=\"text\" onChange={({target: {value}}) => setNewUserData({...newUserData, phone: value})} />\n              </div>\n            </div>\n\n            <div className=\"__right\">\n              <div className=\"field\" style={{zIndex: 7}}>\n                <span>Time Zone:</span>\n                <Select options={editions.time_zone.map((option) => ({\n                  span: option,\n                  value: option\n                }))} selectedOption={newUserData.time_zone} onChange={(value: string) => setNewUserData({...newUserData, time_zone: value})}/>\n              </div>\n\n              <div className=\"field\">\n                <span>Permission:</span>\n                <Select options={editions.permissions.map((option) => ({\n                  span: option,\n                  value: option\n                }))} selectedOption={newUserData.permission as string} onChange={(value: string) => setNewUserData({...newUserData, permission: value})}/>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"fieldset\">\n          \n          <div className=\"legend\">Address</div>\n\n          <div className=\"fields\">\n\n            <div className=\"__left\">\n              <div className=\"field\">\n                <span>Street:</span>\n                <input type=\"text\" onChange={({target: {value}}) => setNewUserData({...newUserData, street: value})} />\n              </div>\n\n              <div className=\"field\">\n                <span>Unit/Apt:</span>\n                <input type=\"text\" onChange={({target: {value}}) => setNewUserData({...newUserData, unit: value})} />\n              </div>\n\n              <div className=\"field\">\n                <span>City:</span>\n                <input type=\"text\" onChange={({target: {value}}) => setNewUserData({...newUserData, city: value})} />\n              </div>\n            </div>\n\n            <div className=\"__right\">\n              <div className=\"field\">\n                <span>State:</span>\n                <Select options={editions.state.map((option) => ({\n                  span: option,\n                  value: option\n                }))} selectedOption={newUserData.State as string} onChange={(value: string) => setNewUserData({...newUserData, State: value})}/>\n              </div>\n\n              <div className=\"field\">\n                <span>Zip:</span>\n                <input type=\"text\" onChange={({target: {value}}) => setNewUserData({...newUserData, zip: value})} />\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"wrapper flex-container sb editing-buttons\">\n          <div />\n          <div className=\"buttons\">\n            <button className=\"_bordered _red\" onClick={() => $router.router.navigate('users', {}, {\n              reload: true\n            })}>\n              Cancel\n            </button>\n            <button disabled={!readyToSave} className=\"_bordered _green\">\n              Save\n            </button>\n          </div>\n        </div>\n\n        {avatarPopup ? (\n          <div className=\"popup imageCrop\" onClick={() => setAvatarPopup(false)}>\n\n            <div className=\"wrapper\" onClick={(e) => e.stopPropagation()}>\n              \n              <div>\n                <input type=\"file\" accept=\"image/*\" onChange={onSelectFile} id=\"file-uploader\" />\n                <button className=\"_wa _iconed _bordered _blue\" onClick={() => document.getElementById('file-uploader')?.click()}>\n                  <Icon icon=\"user-33\" />\n                  <span>Upload a File</span>\n                </button>\n              </div>\n\n              <div>\n                {avatarImageSrc && (\n                  <ReactCrop\n                    src={avatarImageSrc}\n                    crop={avatarCrop}\n                    onChange={(value) => setAvatarCrop(value)}\n                  />\n                )}\n              </div>\n            </div>\n          </div>\n        ) : null}\n      </div>\n    ) : null}\n  </>)\n})\nexport default UsersPage_New\n"]},"metadata":{},"sourceType":"module"}