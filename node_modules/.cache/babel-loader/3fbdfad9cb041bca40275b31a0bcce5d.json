{"ast":null,"code":"import _objectSpread from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/regenerator/index.js\";import axios from\"axios\";import React,{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import Icon from\"../../../components/Icon\";import{nError}from\"../../../funcs\";import{mapDispatchToProps,mapStateToProps}from\"../../../store\";import\"../../../styles/pages/common/entity-edit.sass\";import Select from\"../../../components/Select\";import Checkbox from\"../../../components/Checkbox\";import Switcher from\"../../../components/Switcher\";import classNames from\"classnames\";import{BaseLink,useRoute}from\"react-router5\";import ReactInputMask from\"react-input-mask\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CallCenter_DispatchersPage_Item=connect(mapStateToProps,mapDispatchToProps)(function(props){var $router=useRoute();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),readyToSave=_useState2[0],setReadyToSave=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),editing=_useState4[0],setEditing=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),deleting=_useState6[0],setDeleting=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),readyToDelete=_useState8[0],setReadyToDelete=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),dispatcherData=_useState10[0],setDispatcherData=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),newDispatcherData=_useState12[0],setNewDispatcherData=_useState12[1];// Load info function\nfunction loadInfo(){return _loadInfo.apply(this,arguments);}// Load dispatcher data\nfunction _loadInfo(){_loadInfo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _ref3,_dispatcherData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('/json/call_center_dispatcher.json');case 3:_ref3=_context.sent;_dispatcherData=_ref3.data;setDispatcherData(_dispatcherData);setNewDispatcherData({name:'',active:true,user:_dispatcherData.edit.users[0].user_id,phone:'',is_phone:false,is_softphone:false});setTimeout(function(){return setReadyToSave(false);},100);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);nError(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return _loadInfo.apply(this,arguments);}useEffect(function(){loadInfo();},[]);useEffect(function(){return setReadyToSave(true);},[newDispatcherData]);// Render function\nreturn/*#__PURE__*/_jsx(_Fragment,{children:dispatcherData&&newDispatcherData.active!==undefined?/*#__PURE__*/_jsxs(\"div\",{className:\"CallCenter_DispatchersPage_Item entity-edit\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"top-nav\",children:[/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.phoneNumbers\",className:classNames({_active:$router.route.name===\"call_center.phoneNumbers\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"phone-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Phone Numbers\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.dispatchers\",className:classNames({_active:$router.route.name===\"call_center.dispatchers\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"user-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Dispatchers\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.groups\",className:classNames({_active:$router.route.name===\"call_center.groups\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"user-29\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Groups\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.callFlows\",className:classNames({_active:$router.route.name===\"call_center.callFlows\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"share-7\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Call Flows\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.settings\",className:classNames({_active:$router.route.name===\"call_center.settings\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"gear-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Settings\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper flex-container sb\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Dispatcher\"}),dispatcherData!==null&&dispatcherData!==void 0&&dispatcherData.permissions.edit_dispatcher&&!editing?/*#__PURE__*/_jsx(\"button\",{className:\"_wa _green\",onClick:function onClick(){return setEditing(true);},children:\"Edit\"}):null]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fieldset\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend\",children:\"Main\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"fields\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"__left\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field\",style:{zIndex:6},children:[/*#__PURE__*/_jsx(\"span\",{children:\"Name:\"}),/*#__PURE__*/_jsx(\"input\",{disabled:!editing,type:\"text\",defaultValue:dispatcherData.dispatcher.name,onChange:function onChange(_ref){var value=_ref.target.value;return setNewDispatcherData(_objectSpread(_objectSpread({},newDispatcherData),{},{name:value}));}})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"__right\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field\",style:{zIndex:6},children:[/*#__PURE__*/_jsx(\"span\",{children:\"Active:\"}),/*#__PURE__*/_jsx(Switcher,{disabled:!editing,checked:newDispatcherData.active,onChange:function onChange(value){return setNewDispatcherData(_objectSpread(_objectSpread({},newDispatcherData),{},{active:value}));}})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fieldset\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend\",children:\"Settings\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"fields\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"User:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"input-wrapper\",children:/*#__PURE__*/_jsx(Select,{disabled:!editing,options:dispatcherData.edit.users.map(function(user){return{span:user.user,value:user.user_id};}),selectedOption:newDispatcherData.user,onChange:function onChange(value){return setNewDispatcherData(_objectSpread(_objectSpread({},newDispatcherData),{},{user:value}));}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Phone:\"}),/*#__PURE__*/_jsx(ReactInputMask,{disabled:!editing,type:\"text\",mask:\"+1 (999) 999-9999\",defaultValue:newDispatcherData.phone,onChange:function onChange(_ref2){var value=_ref2.target.value;return setNewDispatcherData(_objectSpread(_objectSpread({},newDispatcherData),{},{phone:value}));}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"__right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Softphone:\"}),/*#__PURE__*/_jsx(Checkbox,{disabled:!editing,contents:\"\",value:newDispatcherData.is_softphone,onChange:function onChange(value){return setNewDispatcherData(_objectSpread(_objectSpread({},newDispatcherData),{},{is_softphone:value}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Phone:\"}),/*#__PURE__*/_jsx(Checkbox,{disabled:!editing,contents:\"\",value:newDispatcherData.is_phone,onChange:function onChange(value){return setNewDispatcherData(_objectSpread(_objectSpread({},newDispatcherData),{},{is_phone:value}));}})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fieldset\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend\",children:\"Info\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"fields\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Date Created:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",defaultValue:dispatcherData.dispatcher.created_at,disabled:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Created by:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",defaultValue:dispatcherData.dispatcher.created_by,disabled:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"__right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Last Edited:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",defaultValue:dispatcherData.dispatcher.last_edited_at,disabled:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Last Edited By:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",defaultValue:dispatcherData.dispatcher.last_edited_by,disabled:true})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fieldset\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend\",children:\"Groups\"}),/*#__PURE__*/_jsxs(\"table\",{className:classNames('table','__hide-on-mobile',{__respectAsidePanel:props.store.navActive.is}),children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Dispatchers\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Call Flow\"})]}),dispatcherData.call_groups.map(function(callGroup,i){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:callGroup.name}),/*#__PURE__*/_jsx(\"td\",{children:callGroup.dispatchers}),/*#__PURE__*/_jsx(\"td\",{children:callGroup.call_flows})]},i);})]}),/*#__PURE__*/_jsx(\"div\",{className:classNames('mobile-table','__show-on-mobile',{__respectAsidePanel:props.store.navActive.is}),children:/*#__PURE__*/_jsx(\"div\",{className:\"mobile-table-items\",children:dispatcherData.call_groups.map(function(callGroup,i){return/*#__PURE__*/_jsxs(\"div\",{className:\"item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"__top\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"b\",{children:callGroup.name})}),/*#__PURE__*/_jsx(\"div\",{children:callGroup.dispatchers})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"__bottom\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"__left\"}),/*#__PURE__*/_jsx(\"div\",{className:\"__right\",children:/*#__PURE__*/_jsx(\"div\",{children:callGroup.call_flows})})]})]},i);})})})]}),editing?/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper flex-container sb editing-buttons\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"_red\",onClick:function onClick(){return setDeleting(true);},children:\"Delete Dispatcher\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"_bordered _red\",onClick:function onClick(){return setEditing(false);},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{disabled:!readyToSave,className:\"_bordered _green\",children:\"Save\"})]})]}):null,deleting?/*#__PURE__*/_jsx(\"div\",{className:\"item-delete-popup\",onClick:function onClick(){return setDeleting(false);},children:/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper\",onClick:function onClick(e){return e.stopPropagation();},children:[/*#__PURE__*/_jsx(\"div\",{className:\"title\",children:\"Delete Dispatcher\"}),/*#__PURE__*/_jsx(\"div\",{className:\"checkbox-wrapper\",children:/*#__PURE__*/_jsx(Checkbox,{contents:\"I understand that after deleting the dispatcher it will not be possible to recover.\",value:readyToDelete,onChange:function onChange(value){return setReadyToDelete(value);}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"_bordered _green\",onClick:function onClick(){return setDeleting(false);},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{disabled:!readyToDelete,className:\"_bordered _red\",children:\"Delete\"})]})]})}):null]}):null});});export default CallCenter_DispatchersPage_Item;","map":{"version":3,"sources":["/Users/nicole/rrrr/crm/src/pages/CallCenter/Dispatchers/Item.tsx"],"names":["axios","React","useEffect","useState","connect","Icon","nError","mapDispatchToProps","mapStateToProps","Select","Checkbox","Switcher","classNames","BaseLink","useRoute","ReactInputMask","CallCenter_DispatchersPage_Item","props","$router","readyToSave","setReadyToSave","editing","setEditing","deleting","setDeleting","readyToDelete","setReadyToDelete","dispatcherData","setDispatcherData","newDispatcherData","setNewDispatcherData","loadInfo","get","data","name","active","user","edit","users","user_id","phone","is_phone","is_softphone","setTimeout","undefined","router","_active","route","permissions","edit_dispatcher","zIndex","dispatcher","value","target","map","span","created_at","created_by","last_edited_at","last_edited_by","__respectAsidePanel","store","navActive","is","call_groups","callGroup","i","dispatchers","call_flows","e","stopPropagation"],"mappings":"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","sourcesContent":["import axios from \"axios\"\nimport React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport Icon from \"../../../components/Icon\"\nimport { nError } from \"../../../funcs\"\nimport { StoreDispatch, StoreState, mapDispatchToProps, mapStateToProps } from \"../../../store\";\nimport Datetime from 'react-datetime'\n\nimport \"../../../styles/pages/common/entity-edit.sass\"\nimport moment from \"moment\"\nimport Select from \"../../../components/Select\"\nimport Checkbox from \"../../../components/Checkbox\"\nimport { CallCenter_CallGroup, CallCenter_Dispatcher } from \"../../../models/CallCenter\"\nimport Switcher from \"../../../components/Switcher\"\nimport classNames from \"classnames\"\nimport { BaseLink, useRoute } from \"react-router5\"\nimport ReactInputMask from \"react-input-mask\"\n\ninterface Props {\n  store: StoreState,\n  dispatcher: StoreDispatch\n}\n\ninterface DispatcherData {\n  \n  permissions: {\n    \n    edit_dispatcher: boolean,\n    show_call_group: true,\n  },\n\n  dispatcher: CallCenter_Dispatcher,\n\n  call_groups: CallCenter_CallGroup[],\n\n  edit: {\n    users: {\n      user_id: string,\n      user: string\n    }[]\n  }\n}\n\nconst CallCenter_DispatchersPage_Item = connect(mapStateToProps, mapDispatchToProps)(function(props: Props) {\n\n  const $router = useRoute()\n\n  const [readyToSave, setReadyToSave] = useState(false)\n\n  const [editing, setEditing] = useState(false)\n\n  const [deleting, setDeleting] = useState(false)\n  const [readyToDelete, setReadyToDelete] = useState(false)\n  \n  const [dispatcherData, setDispatcherData] = useState<DispatcherData | null>(null)\n\n  const [newDispatcherData, setNewDispatcherData] = useState<Partial<CallCenter_Dispatcher>>({\n    \n  })\n  \n  // Load info function\n  async function loadInfo() {\n    try {\n      const { data: dispatcherData } = (await axios.get('/json/call_center_dispatcher.json')) as {data: DispatcherData}\n\n      setDispatcherData(dispatcherData)\n\n      setNewDispatcherData({\n        \n        name: '',\n        active: true,\n\n        user: dispatcherData.edit.users[0].user_id,\n\n        phone: '',\n        is_phone: false,\n        is_softphone: false\n      })\n\n      setTimeout(() => setReadyToSave(false), 100)\n    }\n    catch (error) {\n      nError(error)\n    }\n  }\n\n  // Load dispatcher data\n  useEffect(() => {\n    loadInfo()\n  }, [])\n\n  useEffect(() => setReadyToSave(true), [\n    newDispatcherData\n  ])\n  \n  // Render function\n  return (<>\n    {dispatcherData && newDispatcherData.active !== undefined ? (\n      <div className=\"CallCenter_DispatchersPage_Item entity-edit\">\n\n        {/* Top navigation */}\n        <div className=\"top-nav\">\n          <BaseLink router={$router.router} routeName=\"call_center.phoneNumbers\" className={classNames({_active: $router.route.name === \"call_center.phoneNumbers\"})}>\n            <Icon icon=\"phone-1\" />\n            <span>Phone Numbers</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.dispatchers\" className={classNames({_active: $router.route.name === \"call_center.dispatchers\"})}>\n            <Icon icon=\"user-1\" />\n            <span>Dispatchers</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.groups\" className={classNames({_active: $router.route.name === \"call_center.groups\"})}>\n            <Icon icon=\"user-29\" />\n            <span>Groups</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.callFlows\" className={classNames({_active: $router.route.name === \"call_center.callFlows\"})}>\n            <Icon icon=\"share-7\" />\n            <span>Call Flows</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.settings\" className={classNames({_active: $router.route.name === \"call_center.settings\"})}>\n            <Icon icon=\"gear-1\" />\n            <span>Settings</span>\n          </BaseLink>\n        </div>\n\n        <div className=\"wrapper flex-container sb\">\n          <h1>Dispatcher</h1>\n\n          {dispatcherData?.permissions.edit_dispatcher && !editing ? (\n            <button className=\"_wa _green\" onClick={() => setEditing(true)}>\n              Edit\n            </button>\n          ) : null}\n        </div>\n        \n        <div className=\"fieldset\">\n          \n          <div className=\"legend\">Main</div>\n\n          <div className=\"fields\">\n\n            <div className=\"__left\">\n              <div className=\"field\" style={{zIndex: 6}}>\n                <span>Name:</span>\n                \n                <input disabled={!editing} type=\"text\" defaultValue={dispatcherData.dispatcher.name} onChange={({target: {value}}) => setNewDispatcherData({...newDispatcherData, name: value})} />\n              </div>\n            </div>\n\n            \n            <div className=\"__right\">\n\n              <div className=\"field\" style={{zIndex: 6}}>\n                <span>Active:</span>\n                \n                <Switcher disabled={!editing} checked={newDispatcherData.active as boolean} onChange={(value) => setNewDispatcherData({...newDispatcherData, active: value})} />\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"fieldset\">\n\n          <div className=\"legend\">Settings</div>\n\n          <div className=\"fields\">\n\n            <div className=\"__left\">\n\n              <div className=\"field\">\n                <span>User:</span>\n\n                <div className=\"input-wrapper\">\n                  <Select disabled={!editing} options={dispatcherData.edit.users.map((user) => ({\n                    span: user.user,\n                    value: user.user_id\n                  }))} selectedOption={newDispatcherData.user as string} onChange={(value: string) => setNewDispatcherData({...newDispatcherData, user: value})}/>\n                </div>\n              </div>\n\n              <div className=\"field\">\n                <span>Phone:</span>\n\n                <ReactInputMask disabled={!editing} type=\"text\" mask=\"+1 (999) 999-9999\" defaultValue={newDispatcherData.phone} onChange={({target: {value}}) => setNewDispatcherData({...newDispatcherData, phone: value})} />\n              </div>\n            </div>\n\n            <div className=\"__right\">\n\n              <div className=\"field\">\n                <span>Softphone:</span>\n\n                <Checkbox disabled={!editing} contents='' value={newDispatcherData.is_softphone} onChange={(value) => setNewDispatcherData({...newDispatcherData, is_softphone: value})} />\n              </div>\n\n              <div className=\"field\">\n                <span>Phone:</span>\n\n                <Checkbox disabled={!editing} contents='' value={newDispatcherData.is_phone} onChange={(value) => setNewDispatcherData({...newDispatcherData, is_phone: value})} />\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"fieldset\">\n          \n          <div className=\"legend\">Info</div>\n\n          <div className=\"fields\">\n\n            <div className=\"__left\">\n              <div className=\"field\">\n                <span>Date Created:</span>\n                <input type=\"text\" defaultValue={dispatcherData.dispatcher.created_at} disabled={ true } />\n              </div>\n\n              <div className=\"field\">\n                <span>Created by:</span>\n                <input type=\"text\" defaultValue={dispatcherData.dispatcher.created_by} disabled={ true } />\n              </div>\n            </div>\n\n            \n            <div className=\"__right\">\n\n              <div className=\"field\">\n                <span>Last Edited:</span>\n                <input type=\"text\" defaultValue={dispatcherData.dispatcher.last_edited_at} disabled={ true } />\n              </div>\n\n              <div className=\"field\">\n                <span>Last Edited By:</span>\n                <input type=\"text\" defaultValue={dispatcherData.dispatcher.last_edited_by} disabled={ true } />\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"fieldset\">\n\n          <div className=\"legend\">Groups</div>\n\n          <table className={classNames('table', '__hide-on-mobile', {\n            __respectAsidePanel: props.store.navActive.is\n          })}>\n            <tr>\n              <th>Name</th>\n              <th>Dispatchers</th>\n              <th>Call Flow</th>\n            </tr>\n            {dispatcherData.call_groups.map((callGroup, i) => (\n              <tr key={i}>\n                <td>{callGroup.name}</td>\n                <td>{callGroup.dispatchers}</td>\n                <td>{callGroup.call_flows}</td>\n              </tr>\n            ))}\n          </table>\n\n          <div className={classNames('mobile-table', '__show-on-mobile', {\n            __respectAsidePanel: props.store.navActive.is\n          })}>\n\n            <div className=\"mobile-table-items\">\n\n              {dispatcherData.call_groups.map((callGroup, i: number) => (\n                <div className=\"item\" key={i}>\n\n                  <div className=\"__top\">\n\n                    <div className=\"__left\">\n                      <div><b>{callGroup.name}</b></div>\n                      <div>\n                        {callGroup.dispatchers}\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"__bottom\">\n\n                    <div className=\"__left\">\n                      \n                    </div>\n\n                    <div className=\"__right\">\n                      <div>\n                        {callGroup.call_flows}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n\n        {editing ? (\n          <div className=\"wrapper flex-container sb editing-buttons\">\n            <div>\n              <button className=\"_red\" onClick={() => setDeleting(true)}>Delete Dispatcher</button>\n            </div>\n            <div className=\"buttons\">\n              <button className=\"_bordered _red\" onClick={() => setEditing(false)}>\n                Cancel\n              </button>\n              <button disabled={!readyToSave} className=\"_bordered _green\">\n                Save\n              </button>\n            </div>\n          </div>\n        ) : null}\n\n        {/* Item share popup */}\n        {deleting ? (\n          <div className=\"item-delete-popup\" onClick={() => setDeleting(false)}>\n\n            <div className=\"wrapper\" onClick={(e) => e.stopPropagation()}>\n            \n              <div className=\"title\">\n                Delete Dispatcher\n              </div>\n\n              <div className=\"checkbox-wrapper\">\n                <Checkbox contents=\"I understand that after deleting the dispatcher it will not be possible to recover.\" value={readyToDelete} onChange={(value) => setReadyToDelete(value)} />\n              </div>\n\n              <div className=\"buttons\">\n\n                <button className=\"_bordered _green\" onClick={() => setDeleting(false)}>\n                  Cancel\n                </button>\n\n                <button disabled={!readyToDelete} className=\"_bordered _red\">\n                  Delete\n                </button>\n              </div>\n            </div>\n          </div>\n        ) : null}\n      </div>\n    ) : null}\n  </>)\n})\nexport default CallCenter_DispatchersPage_Item\n"]},"metadata":{},"sourceType":"module"}