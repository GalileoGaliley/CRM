{"ast":null,"code":"import _defineProperty from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/regenerator/index.js\";import axios from\"axios\";import classNames from\"classnames\";import{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import{useRoute}from\"react-router5\";import Icon from\"../../components/Icon\";import ReportFilters from\"../../components/reports/Filters\";import ReportTableControls from\"../../components/reports/TableControls\";import ReportTableField from\"../../components/reports/TableField\";import{nError}from\"../../funcs\";import{mapDispatchToProps,mapStateToProps}from\"../../store\";import\"../../styles/pages/common/report-list.sass\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UsersPage_List=connect(mapStateToProps,mapDispatchToProps)(function(props){var $router=useRoute();var _useState=useState(Math.random()),_useState2=_slicedToArray(_useState,2),$updater=_useState2[0],$setUpdater=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),reportData=_useState4[0],setReportData=_useState4[1];var _useState5=useState({search:'',page:1,filter_words:{function:[],time_zone:[],permissions:[],active:[]},sort:{field:'first_name',direction:'up'},sortFields:[{span:'First Name',value:'first_name'},{span:'Last Name',value:'last_name'},{span:'Function',value:'function'},{span:'Phone',value:'phone'},{span:'Email',value:'email'},{span:'Time Zone',value:'time_zone'},{span:'Permissions',value:'permissions'},{span:'Active',value:'active'}]}),_useState6=_slicedToArray(_useState5,2),localInterface=_useState6[0],setLocalInterface=_useState6[1];// Load users function\nfunction loadUsers(){return _loadUsers.apply(this,arguments);}// Load users on page mount\nfunction _loadUsers(){_loadUsers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _ref,users;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('/json/users.json');case 3:_ref=_context.sent;users=_ref.data;setReportData(users);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);nError(_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return _loadUsers.apply(this,arguments);}useEffect(function(){loadUsers();},[$updater,localInterface.page]);// Is filter selected function\nfunction isFilterSelected(field,value){return localInterface.filter_words[field].includes(value);}// Is all filters selected function\nfunction isAllFiltersSelected(field){return localInterface.filter_words[field].length===0;}// Filter switch function\nfunction switchFilter(field,value,toggle){var _arr=_toConsumableArray(localInterface.filter_words[field]);if(toggle&&value===\"All\"){_arr=[];}else if(!toggle){while(true){var i=_arr.findIndex(function(filter){return filter===value;});if(i===-1)break;_arr.splice(i,1);}}else{if(reportData!==null&&reportData!==void 0&&reportData.interface.filter_words[field].every(function(option){return _arr.concat([value]).includes(option);}))_arr=[];else if(_arr.findIndex(function(filter){return filter===value;})===-1)_arr.push(value);}setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{filter_words:_objectSpread(_objectSpread({},localInterface.filter_words),{},_defineProperty({},field,_arr))}));}// Render function\nreturn/*#__PURE__*/_jsx(_Fragment,{children:reportData?/*#__PURE__*/_jsxs(\"div\",{className:\"UsersPage_List\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Users\"})}),/*#__PURE__*/_jsx(ReportFilters,{onSearchInputChange:function onSearchInputChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{search:value}));},onUpdate:function onUpdate(){return 2;}}),/*#__PURE__*/_jsx(ReportTableControls,{zIndex:5,onMaxRowsChange:function onMaxRowsChange(){return $setUpdater(Math.random());},amount:{total:reportData.interface.rows_all,start:reportData.interface.rows_start,end:reportData.interface.rows_end},page:localInterface.page,maxPages:reportData.interface.max_pages,onPagesStart:function onPagesStart(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:1}));},onPrevPage:function onPrevPage(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:localInterface.page-1}));},onNextPage:function onNextPage(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:localInterface.page+1}));},onPagesEnd:function onPagesEnd(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:reportData.interface.max_pages}));},sort:localInterface.sort,sortFields:localInterface.sortFields,onSortFieldChange:function onSortFieldChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:_objectSpread(_objectSpread({},localInterface.sort),{},{field:value})}));},onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:_objectSpread(_objectSpread({},localInterface.sort),{},{direction:value})}));},onSortFire:function onSortFire(){return 0;},addButton:/*#__PURE__*/_jsx(\"div\",{className:\"add-button-wrapper\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"_iconed _rounded add-button\",onClick:function onClick(){return $router.router.navigate('users.new');},children:[/*#__PURE__*/_jsx(Icon,{icon:\"plus-thin\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Add user\"}),/*#__PURE__*/_jsx(Icon,{icon:\"user-1\"})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"contents\",children:[/*#__PURE__*/_jsxs(\"table\",{className:classNames('table','__show-on-wide',{__respectAsidePanel:props.store.navActive.is}),children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(ReportTableField,{contents:/*#__PURE__*/_jsx(\"span\",{children:\"First Name\"}),sortDirection:localInterface.sort.field==='first_name'?localInterface.sort.direction:undefined,onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:{field:'first_name',direction:value}}));},onFilterFire:function onFilterFire(){return $setUpdater(Math.random());}}),/*#__PURE__*/_jsx(ReportTableField,{contents:/*#__PURE__*/_jsx(\"span\",{children:\"Last Name\"}),sortDirection:localInterface.sort.field==='last_name'?localInterface.sort.direction:undefined,onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:{field:'last_name',direction:value}}));},onFilterFire:function onFilterFire(){return $setUpdater(Math.random());}}),/*#__PURE__*/_jsx(ReportTableField,{contents:/*#__PURE__*/_jsx(\"span\",{children:\"Function\"}),sortDirection:localInterface.sort.field==='function'?localInterface.sort.direction:undefined,onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:{field:'function',direction:value}}));},onFilterFire:function onFilterFire(){return $setUpdater(Math.random());}}),/*#__PURE__*/_jsx(ReportTableField,{contents:/*#__PURE__*/_jsx(\"span\",{children:\"Phone\"}),sortDirection:localInterface.sort.field==='phone'?localInterface.sort.direction:undefined,onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:{field:'phone',direction:value}}));},onFilterFire:function onFilterFire(){return $setUpdater(Math.random());}}),/*#__PURE__*/_jsx(ReportTableField,{contents:/*#__PURE__*/_jsx(\"span\",{children:\"Email\"}),sortDirection:localInterface.sort.field==='email'?localInterface.sort.direction:undefined,onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:{field:'email',direction:value}}));},onFilterFire:function onFilterFire(){return $setUpdater(Math.random());}}),/*#__PURE__*/_jsx(ReportTableField,{contents:/*#__PURE__*/_jsx(\"span\",{children:\"Time zone\"}),allFiltersSelected:isAllFiltersSelected(\"time_zone\"),onAllFiltersChange:function onAllFiltersChange(value){return switchFilter(\"time_zone\",\"All\",value);},filterWords:reportData.interface.filter_words.time_zone.map(function(filterWord){return{word:filterWord,selected:isFilterSelected(\"time_zone\",filterWord)};}),onFilterChange:function onFilterChange(value){return switchFilter(\"time_zone\",value.word,value.selected);},sortDirection:localInterface.sort.field==='time_zone'?localInterface.sort.direction:undefined,onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:{field:'time_zone',direction:value}}));},onFilterFire:function onFilterFire(){return $setUpdater(Math.random());}}),/*#__PURE__*/_jsx(ReportTableField,{contents:/*#__PURE__*/_jsx(\"span\",{children:\"Permissions\"}),allFiltersSelected:isAllFiltersSelected(\"permissions\"),onAllFiltersChange:function onAllFiltersChange(value){return switchFilter(\"permissions\",\"All\",value);},filterWords:reportData.interface.filter_words.permissions.map(function(filterWord){return{word:filterWord,selected:isFilterSelected(\"permissions\",filterWord)};}),onFilterChange:function onFilterChange(value){return switchFilter(\"permissions\",value.word,value.selected);},sortDirection:localInterface.sort.field==='permissions'?localInterface.sort.direction:undefined,onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:{field:'permissions',direction:value}}));},onFilterFire:function onFilterFire(){return $setUpdater(Math.random());}}),/*#__PURE__*/_jsx(ReportTableField,{contents:/*#__PURE__*/_jsx(\"span\",{children:\"Active\"}),allFiltersSelected:isAllFiltersSelected(\"active\"),onAllFiltersChange:function onAllFiltersChange(value){return switchFilter(\"active\",\"All\",value);},filterWords:reportData.interface.filter_words.active.map(function(filterWord){return{word:filterWord,selected:isFilterSelected(\"active\",filterWord)};}),onFilterChange:function onFilterChange(value){return switchFilter(\"active\",value.word,value.selected);},sortDirection:localInterface.sort.field==='active'?localInterface.sort.direction:undefined,onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:{field:'active',direction:value}}));},onFilterFire:function onFilterFire(){return $setUpdater(Math.random());}})]}),reportData.users.map(function(user,i){return/*#__PURE__*/_jsxs(\"tr\",{onClick:function onClick(){return $router.router.navigate('users.item',{userId:user.user_id},{reload:true});},children:[/*#__PURE__*/_jsx(\"td\",{children:user.first_name}),/*#__PURE__*/_jsx(\"td\",{children:user.last_name}),/*#__PURE__*/_jsx(\"td\",{children:user.function}),/*#__PURE__*/_jsx(\"td\",{children:user.phone}),/*#__PURE__*/_jsx(\"td\",{children:user.email}),/*#__PURE__*/_jsx(\"td\",{children:user.time_zone}),/*#__PURE__*/_jsx(\"td\",{children:user.permissions}),/*#__PURE__*/_jsx(\"td\",{className:classNames({'red-text':user.active==='Inactive','green-text':user.active==='Active','blue-text':user.active==='Waiting'}),children:user.active})]},i);})]}),/*#__PURE__*/_jsxs(\"table\",{className:classNames('table','__hide-on-wide','__hide-on-mobile',{__respectAsidePanel:props.store.navActive.is}),children:[/*#__PURE__*/_jsx(\"tr\",{}),reportData.users.map(function(user,i){return/*#__PURE__*/_jsxs(\"tr\",{onClick:function onClick(){return $router.router.navigate('users.item',{userId:user.user_id},{reload:true});},children:[/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[user.first_name,\" \",user.last_name]}),/*#__PURE__*/_jsx(\"div\",{children:user.email})]}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"div\",{children:user.phone}),/*#__PURE__*/_jsx(\"div\",{children:user.time_zone})]}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Function: \",user.function]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Permissions: \",user.permissions]})]}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"div\",{className:classNames({'red-text':user.active==='Inactive','green-text':user.active==='Active','blue-text':user.active==='Waiting'}),children:user.active}),/*#__PURE__*/_jsx(\"div\",{children:\"\\xA0\"})]})]},i);})]}),/*#__PURE__*/_jsx(\"div\",{className:classNames('mobile-table-items','__show-on-mobile',{__respectAsidePanel:props.store.navActive.is}),children:reportData.users.map(function(user,i){return/*#__PURE__*/_jsxs(\"div\",{className:\"item\",onClick:function onClick(){return $router.router.navigate('users.item',{userId:user.user_id},{reload:true});},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__top\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"b\",{children:[user.first_name,\" \",user.last_name]})}),/*#__PURE__*/_jsx(\"div\",{children:user.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"__right\",children:[/*#__PURE__*/_jsx(\"div\",{className:classNames({'red-text':user.active==='Inactive','green-text':user.active==='Active','blue-text':user.active==='Waiting'}),children:user.active}),/*#__PURE__*/_jsx(\"div\",{children:user.phone})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"__bottom\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"gray\",children:\"Functions:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\" \",user.function]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"gray\",children:\"Permissions:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\" \",user.permissions]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"__right small\",children:/*#__PURE__*/_jsx(\"div\",{children:user.time_zone})})]})]},i);})})]}),/*#__PURE__*/_jsx(ReportTableControls,{isUnder:true,onMaxRowsChange:function onMaxRowsChange(){return $setUpdater(Math.random());},amount:{total:reportData.interface.rows_all,start:reportData.interface.rows_start,end:reportData.interface.rows_end},page:localInterface.page,maxPages:reportData.interface.max_pages,onPagesStart:function onPagesStart(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:1}));},onPrevPage:function onPrevPage(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:localInterface.page-1}));},onNextPage:function onNextPage(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:localInterface.page+1}));},onPagesEnd:function onPagesEnd(){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{page:reportData.interface.max_pages}));},sort:localInterface.sort,sortFields:localInterface.sortFields,onSortFieldChange:function onSortFieldChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:_objectSpread(_objectSpread({},localInterface.sort),{},{field:value})}));},onSortDirectionChange:function onSortDirectionChange(value){return setLocalInterface(_objectSpread(_objectSpread({},localInterface),{},{sort:_objectSpread(_objectSpread({},localInterface.sort),{},{direction:value})}));},onSortFire:function onSortFire(){return 0;}})]}):null});});export default UsersPage_List;","map":{"version":3,"sources":["/Users/nicole/rrrr/crm/src/pages/Users/List.tsx"],"names":["axios","classNames","useEffect","useState","connect","useRoute","Icon","ReportFilters","ReportTableControls","ReportTableField","nError","mapDispatchToProps","mapStateToProps","UsersPage_List","props","$router","Math","random","$updater","$setUpdater","reportData","setReportData","search","page","filter_words","function","time_zone","permissions","active","sort","field","direction","sortFields","span","value","localInterface","setLocalInterface","loadUsers","get","users","data","isFilterSelected","includes","isAllFiltersSelected","length","switchFilter","toggle","_arr","i","findIndex","filter","splice","interface","every","option","concat","push","total","rows_all","start","rows_start","end","rows_end","max_pages","router","navigate","__respectAsidePanel","store","navActive","is","undefined","map","filterWord","word","selected","user","userId","user_id","reload","first_name","last_name","phone","email"],"mappings":"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","sourcesContent":["import axios from \"axios\"\nimport classNames from \"classnames\"\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { useRoute } from \"react-router5\"\nimport Icon from \"../../components/Icon\"\nimport ReportFilters from \"../../components/reports/Filters\"\nimport ReportTableControls from \"../../components/reports/TableControls\"\nimport ReportTableField from \"../../components/reports/TableField\"\nimport { nError } from \"../../funcs\"\nimport User from \"../../models/User\"\nimport { StoreDispatch, StoreState, mapDispatchToProps, mapStateToProps } from \"../../store\";\n\nimport \"../../styles/pages/common/report-list.sass\"\n\ninterface Props {\n  store: StoreState,\n  dispatcher: StoreDispatch\n}\n\ntype FilterWord = 'function' | 'time_zone' | 'permissions' | 'active'\n\ninterface UsersReport {\n\n  interface: {\n\n    filter_words: {\n\n      function: string[],\n      time_zone: string[],\n      permissions: string[],\n      active: string[]\n    },\n\n    max_pages: number,\n    rows_start: number,\n    rows_end: number,\n    rows_all: number,\n  },\n\n  permissions: {\n    show_user: boolean,\n    add_user: boolean\n  },\n\n  users: User[],\n\n  edit: {\n    time_zone: string[],\n    permissions: string[],\n    state: string[]\n  }\n}\n\nconst UsersPage_List = connect(mapStateToProps, mapDispatchToProps)(function(props: Props) {\n\n  const $router = useRoute()\n\n  const [$updater, $setUpdater] = useState<any>(Math.random())\n\n  const [reportData, setReportData] = useState<UsersReport | null>(null)\n  const [localInterface, setLocalInterface] = useState({\n\n    search: '',\n\n    page: 1,\n\n    filter_words: {\n\n      function: [] as string[],\n      time_zone: [] as string[],\n      permissions: [] as string[],\n      active: [] as string[],\n    },\n\n    sort: {\n      field: 'first_name',\n      direction: 'up' as 'up' | 'down'\n    },\n    sortFields: [{\n      span: 'First Name',\n      value: 'first_name'\n    },{\n      span: 'Last Name',\n      value: 'last_name'\n    },{\n      span: 'Function',\n      value: 'function'\n    },{\n      span: 'Phone',\n      value: 'phone'\n    },{\n      span: 'Email',\n      value: 'email'\n    },{\n      span: 'Time Zone',\n      value: 'time_zone'\n    },{\n      span: 'Permissions',\n      value: 'permissions'\n    },{\n      span: 'Active',\n      value: 'active'\n    }]\n\n  })\n\n  // Load users function\n  async function loadUsers() {\n\n    try {\n      const { data: users } = (await axios.get('/json/users.json')) as {data: UsersReport}\n\n      setReportData(users)\n    }\n    catch (error) {\n      nError(error)\n    }\n  }\n\n  // Load users on page mount\n  useEffect(() => { loadUsers() }, [\n    $updater,\n    localInterface.page\n  ])\n\n  // Is filter selected function\n  function isFilterSelected(field: FilterWord, value: string) {\n    return localInterface.filter_words[field].includes(value)\n  }\n\n  // Is all filters selected function\n  function isAllFiltersSelected(field: FilterWord) {\n    return localInterface.filter_words[field].length === 0\n  }\n\n  // Filter switch function\n  function switchFilter(field: FilterWord, value: string, toggle: boolean) {\n\n    let _arr = [...localInterface.filter_words[field]]\n\n    if (toggle && value === \"All\") { _arr = [] }\n    \n    else if (!toggle) {\n\n      while (true) {\n        let i = _arr.findIndex((filter) => filter === value)\n        if(i === -1) break\n        _arr.splice(i, 1)\n      }\n    }\n      \n    else {\n\n      if (reportData?.interface.filter_words[field].every((option) => _arr.concat([value]).includes(option)))\n        _arr = []\n\n      else if(_arr.findIndex((filter) => filter === value) === -1)\n        _arr.push(value)\n    }\n\n    setLocalInterface({...localInterface, filter_words: {...localInterface.filter_words, [field]: _arr}})\n  }\n\n  // Render function\n  return (<>\n    {reportData ? (\n      <div className=\"UsersPage_List\" >\n\n        { /* Page header */}\n        <div className=\"page-header\">\n          <h1>Users</h1>\n        </div>\n\n        { /* List filters */}\n        <ReportFilters\n          onSearchInputChange={(value) => setLocalInterface({...localInterface, search: value})}\n\n          onUpdate={() => 2}\n        />\n\n        {/* Table controls */}\n        <ReportTableControls\n          zIndex={5}\n\n          onMaxRowsChange={() => $setUpdater(Math.random())}\n\n          amount={{\n            total: reportData.interface.rows_all,\n            start: reportData.interface.rows_start,\n            end: reportData.interface.rows_end\n          }}\n\n          page={localInterface.page}\n          maxPages={reportData.interface.max_pages}\n          onPagesStart={() => setLocalInterface({...localInterface, page: 1})}\n          onPrevPage={() => setLocalInterface({...localInterface, page: localInterface.page-1})}\n          onNextPage={() => setLocalInterface({...localInterface, page: localInterface.page+1})}\n          onPagesEnd={() => setLocalInterface({...localInterface, page: reportData.interface.max_pages})}\n          \n          sort={localInterface.sort}\n          sortFields={localInterface.sortFields}\n          onSortFieldChange={(value) => setLocalInterface({...localInterface, sort: {...localInterface.sort, field: value}})}\n          onSortDirectionChange={(value) => setLocalInterface({ ...localInterface, sort: { ...localInterface.sort, direction: value } })}\n          onSortFire={() => 0}\n          \n          addButton={(\n            <div className=\"add-button-wrapper\">\n              <button className=\"_iconed _rounded add-button\" onClick={() => $router.router.navigate('users.new')}>\n                <Icon icon=\"plus-thin\" />\n                <span>Add user</span>\n                <Icon icon=\"user-1\" />\n              </button>\n            </div>\n          )}\n        />\n\n        <div className=\"contents\">\n\n          {/* Wide desktop table */}\n          <table className={classNames('table', '__show-on-wide', {\n            __respectAsidePanel: props.store.navActive.is\n          })}>\n            <tr>\n              <ReportTableField\n                contents={(<span>First Name</span>)}\n\n                sortDirection={localInterface.sort.field === 'first_name' ? localInterface.sort.direction : undefined}\n                onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {field: 'first_name', direction: value}})}\n\n                onFilterFire={() => $setUpdater(Math.random())}\n              />\n              <ReportTableField\n                contents={(<span>Last Name</span>)}\n\n                sortDirection={localInterface.sort.field === 'last_name' ? localInterface.sort.direction : undefined}\n                onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {field: 'last_name', direction: value}})}\n\n                onFilterFire={() => $setUpdater(Math.random())}\n              />\n              <ReportTableField\n                contents={(<span>Function</span>)}\n\n                sortDirection={localInterface.sort.field === 'function' ? localInterface.sort.direction : undefined}\n                onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {field: 'function', direction: value}})}\n\n                onFilterFire={() => $setUpdater(Math.random())}\n              />\n              <ReportTableField\n                contents={(<span>Phone</span>)}\n\n                sortDirection={localInterface.sort.field === 'phone' ? localInterface.sort.direction : undefined}\n                onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {field: 'phone', direction: value}})}\n\n                onFilterFire={() => $setUpdater(Math.random())}\n              />\n              <ReportTableField\n                contents={(<span>Email</span>)}\n\n                sortDirection={localInterface.sort.field === 'email' ? localInterface.sort.direction : undefined}\n                onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {field: 'email', direction: value}})}\n\n                onFilterFire={() => $setUpdater(Math.random())}\n              />\n              <ReportTableField\n                contents={(<span>Time zone</span>)}\n\n                allFiltersSelected={isAllFiltersSelected(\"time_zone\")}\n                onAllFiltersChange={(value) => switchFilter(\"time_zone\", \"All\", value)}\n\n                filterWords={reportData.interface.filter_words.time_zone.map((filterWord) => ({\n                  word: filterWord,\n                  selected: isFilterSelected(\"time_zone\", filterWord)\n                }))}\n                onFilterChange={(value) => switchFilter(\"time_zone\", value.word, value.selected)}\n\n                sortDirection={localInterface.sort.field === 'time_zone' ? localInterface.sort.direction : undefined}\n                onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {field: 'time_zone', direction: value}})}\n\n                onFilterFire={() => $setUpdater(Math.random())}\n              />\n              <ReportTableField\n                contents={(<span>Permissions</span>)}\n\n                allFiltersSelected={isAllFiltersSelected(\"permissions\")}\n                onAllFiltersChange={(value) => switchFilter(\"permissions\", \"All\", value)}\n\n                filterWords={reportData.interface.filter_words.permissions.map((filterWord) => ({\n                  word: filterWord,\n                  selected: isFilterSelected(\"permissions\", filterWord)\n                }))}\n                onFilterChange={(value) => switchFilter(\"permissions\", value.word, value.selected)}\n\n                sortDirection={localInterface.sort.field === 'permissions' ? localInterface.sort.direction : undefined}\n                onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {field: 'permissions', direction: value}})}\n\n                onFilterFire={() => $setUpdater(Math.random())}\n              />\n              <ReportTableField\n                contents={(<span>Active</span>)}\n\n                allFiltersSelected={isAllFiltersSelected(\"active\")}\n                onAllFiltersChange={(value) => switchFilter(\"active\", \"All\", value)}\n\n                filterWords={reportData.interface.filter_words.active.map((filterWord) => ({\n                  word: filterWord,\n                  selected: isFilterSelected(\"active\", filterWord)\n                }))}\n                onFilterChange={(value) => switchFilter(\"active\", value.word, value.selected)}\n\n                sortDirection={localInterface.sort.field === 'active' ? localInterface.sort.direction : undefined}\n                onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {field: 'active', direction: value}})}\n\n                onFilterFire={() => $setUpdater(Math.random())}\n              />\n            </tr>\n            {reportData.users.map((user, i) => (\n              <tr key={i} onClick={() => $router.router.navigate('users.item', {\n                userId: user.user_id\n              }, {reload: true})}>\n                <td>{user.first_name}</td>\n                <td>{user.last_name}</td>\n                <td>{user.function}</td>\n                <td>{user.phone}</td>\n                <td>{user.email}</td>\n                <td>{user.time_zone}</td>\n                <td>{user.permissions}</td>\n                <td className={classNames({\n                  'red-text': user.active === 'Inactive',\n                  'green-text': user.active === 'Active',\n                  'blue-text': user.active === 'Waiting',\n                })}>{user.active}</td>\n              </tr>\n            ))}\n          </table>\n\n          {/* Medium screen table */}\n          <table className={classNames('table', '__hide-on-wide', '__hide-on-mobile', {\n            __respectAsidePanel: props.store.navActive.is\n          })}>\n            <tr></tr>\n            {reportData.users.map((user, i) => (\n              <tr key={i} onClick={() => $router.router.navigate('users.item', {\n                userId: user.user_id\n              }, {reload: true})}>\n                <td>\n                  <div>{user.first_name} {user.last_name}</div>\n                  <div>{user.email}</div>\n                </td>\n                <td>\n                  <div>{user.phone}</div>\n                  <div>{user.time_zone}</div>\n                </td>\n                <td>\n                  <div>Function: {user.function}</div>\n                  <div>Permissions: {user.permissions}</div>\n                </td>\n                <td>\n                  <div className={classNames({\n                    'red-text': user.active === 'Inactive',\n                    'green-text': user.active === 'Active',\n                    'blue-text': user.active === 'Waiting',\n                  })}>\n                    {user.active}\n                  </div>\n                  <div>&nbsp;</div>\n                </td>\n              </tr>\n            ))}\n          </table>\n\n          {/* Mobile table items */}\n          <div className={classNames('mobile-table-items', '__show-on-mobile', {\n            __respectAsidePanel: props.store.navActive.is\n          })}>\n\n            {reportData.users.map((user, i: number) => (\n              <div className=\"item\" key={i} onClick={() => $router.router.navigate('users.item', {\n                userId: user.user_id\n              }, {reload: true})}>\n\n                <div className=\"__top\">\n\n                  <div className=\"__left\">\n                    <div><b>{user.first_name} {user.last_name}</b></div>\n                    <div>\n                      {user.email}\n                    </div>\n                  </div>\n\n                  <div className=\"__right\">\n                    <div className={classNames({\n                      'red-text': user.active === 'Inactive',\n                      'green-text': user.active === 'Active',\n                      'blue-text': user.active === 'Waiting',\n                    })}>\n                      {user.active}\n                    </div>\n                    <div>\n                      {user.phone}\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"__bottom\">\n\n                  <div className=\"__left\">\n                    <div>\n                      <span className=\"gray\">Functions:</span>\n                      <span> {user.function}</span>\n                    </div>\n                    <div>\n                      <span className=\"gray\">Permissions:</span>\n                      <span> {user.permissions}</span>\n                    </div>\n                  </div>\n\n                  <div className=\"__right small\">\n                    <div>\n                      {user.time_zone}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Table controls */}\n        <ReportTableControls\n          isUnder={true}\n\n          onMaxRowsChange={() => $setUpdater(Math.random())}\n\n          amount={{\n            total: reportData.interface.rows_all,\n            start: reportData.interface.rows_start,\n            end: reportData.interface.rows_end\n          }}\n\n          page={localInterface.page}\n          maxPages={reportData.interface.max_pages}\n          onPagesStart={() => setLocalInterface({...localInterface, page: 1})}\n          onPrevPage={() => setLocalInterface({...localInterface, page: localInterface.page-1})}\n          onNextPage={() => setLocalInterface({...localInterface, page: localInterface.page+1})}\n          onPagesEnd={() => setLocalInterface({...localInterface, page: reportData.interface.max_pages})}\n          \n          sort={localInterface.sort}\n          sortFields={localInterface.sortFields}\n          onSortFieldChange={(value) => setLocalInterface({...localInterface, sort: {...localInterface.sort, field: value}})}\n          onSortDirectionChange={(value) => setLocalInterface({...localInterface, sort: {...localInterface.sort, direction: value}})}\n          onSortFire={() => 0}\n        />\n      </div>\n    ) : null}\n  </>)\n})\nexport default UsersPage_List\n"]},"metadata":{},"sourceType":"module"}