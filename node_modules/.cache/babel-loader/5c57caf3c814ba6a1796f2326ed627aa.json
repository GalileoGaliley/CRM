{"ast":null,"code":"import _objectSpread from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/nicole/rrrr/crm/node_modules/@babel/runtime/regenerator/index.js\";import axios from\"axios\";import{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import Icon from\"../../../components/Icon\";import{nError}from\"../../../funcs\";import{mapDispatchToProps,mapStateToProps}from\"../../../store\";import\"../../../styles/pages/common/entity-edit.sass\";import Select from\"../../../components/Select\";import{BaseLink,useRoute}from\"react-router5\";import classNames from\"classnames\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var emptyCallGroup={call_group_id:'',name:'',dispatchers:'',call_flows:''};var CallCenter_CallFlowsPage_New=connect(mapStateToProps,mapDispatchToProps)(function(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),readyToSave=_useState2[0],setReadyToSave=_useState2[1];var $router=useRoute();var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),callGroupsData=_useState4[0],setCallGroupsData=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),callGroups=_useState6[0],setCallGroups=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),availableCallGroups=_useState8[0],setAvailableCallGroups=_useState8[1];var _useState9=useState(emptyCallGroup),_useState10=_slicedToArray(_useState9,2),selectedCallGroup=_useState10[0],setSelectedCallGroup=_useState10[1];var _useState11=useState({name:'',phrase_start:'',phrase_office_closed:'',phrase_office_temporary_closed:'',phrase_phone_not_available:'',phrase_dispatcher_not_available:''}),_useState12=_slicedToArray(_useState11,2),newCallFlowData=_useState12[0],setNewCallFlowData=_useState12[1];// Load info function\nfunction loadInfo(){return _loadInfo.apply(this,arguments);}// Load callFlow data\nfunction _loadInfo(){_loadInfo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,callFlowsData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('/json/call_center_call_flows.json');case 3:_yield$axios$get=_context.sent;callFlowsData=_yield$axios$get.data;setCallGroups(callFlowsData.edit.call_groups);setAvailableCallGroups([emptyCallGroup].concat(callFlowsData.edit.call_groups));setSelectedCallGroup(emptyCallGroup);setTimeout(function(){return setReadyToSave(false);},100);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);nError(_context.t0);case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return _loadInfo.apply(this,arguments);}useEffect(function(){loadInfo();},[]);// Add callGroup function\nfunction addCallGroup(){if(!callGroupsData||!newCallFlowData)return;var newCallGroupsList=[].concat(_toConsumableArray(callGroupsData),[selectedCallGroup]);setCallGroupsData(newCallGroupsList);var _availableCallGroups=_toConsumableArray(availableCallGroups);_availableCallGroups=_availableCallGroups.filter(function($callGroup){return newCallGroupsList.findIndex(function(callGroup){return callGroup.name===$callGroup.name;})===-1;});setAvailableCallGroups(_toConsumableArray(_availableCallGroups));setSelectedCallGroup(emptyCallGroup);setReadyToSave(true);}// Remove callGroup function\nfunction removeCallGroup(i){var _callFlowCallGroups=_toConsumableArray(callGroupsData);var _callGroup=_callFlowCallGroups[i];_callFlowCallGroups.splice(i,1);setCallGroupsData(_callFlowCallGroups);setAvailableCallGroups([].concat(_toConsumableArray(availableCallGroups),[_callGroup]));setReadyToSave(true);}useEffect(function(){return setReadyToSave(true);},[newCallFlowData]);// Render function\nreturn/*#__PURE__*/_jsx(_Fragment,{children:true?/*#__PURE__*/_jsxs(\"div\",{className:\"CallCenter_CallFlowsPage_New entity-edit\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"top-nav\",children:[/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.phoneNumbers\",className:classNames({_active:$router.route.name===\"call_center.phoneNumbers\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"phone-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Phone Numbers\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.dispatchers\",className:classNames({_active:$router.route.name===\"call_center.dispatchers\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"user-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Dispatchers\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.groups\",className:classNames({_active:$router.route.name===\"call_center.groups\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"user-29\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Groups\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.callFlows\",className:classNames({_active:$router.route.name===\"call_center.callFlows\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"share-7\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Call Flows\"})]}),/*#__PURE__*/_jsxs(BaseLink,{router:$router.router,routeName:\"call_center.settings\",className:classNames({_active:$router.route.name===\"call_center.settings\"}),children:[/*#__PURE__*/_jsx(Icon,{icon:\"gear-1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Settings\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"wrapper flex-container sb\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"New Call Flow\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"fieldset\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend\",children:\"Main\"}),/*#__PURE__*/_jsx(\"div\",{className:\"fields\",children:/*#__PURE__*/_jsx(\"div\",{className:\"__left\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(_ref){var value=_ref.target.value;return setNewCallFlowData(_objectSpread(_objectSpread({},newCallFlowData),{},{name:value}));}})]})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fieldset\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-container sb wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend\",children:\"Call Groups\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"legend-action-wrapper\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Call Group:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-wrapper\",children:[/*#__PURE__*/_jsx(Select,{options:availableCallGroups.map(function(callGroup){return{span:callGroup.name,value:callGroup.name};}),selectedOption:selectedCallGroup.name,onChange:function onChange(value){return setSelectedCallGroup(availableCallGroups.find(function(_callGroup){return _callGroup.name===value;}));}}),/*#__PURE__*/_jsx(\"button\",{disabled:!selectedCallGroup.name,className:\"_green\",onClick:function onClick(){return addCallGroup();},children:\"Add\"})]})]})]}),/*#__PURE__*/_jsxs(\"table\",{className:classNames('table','__hide-on-mobile',{__respectAsidePanel:props.store.navActive.is}),children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Dispatchers\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Call Flow\"}),/*#__PURE__*/_jsx(\"th\",{})]}),callGroupsData.map(function(callGroup,i){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:callGroup.name}),/*#__PURE__*/_jsx(\"td\",{children:callGroup.dispatchers}),/*#__PURE__*/_jsx(\"td\",{children:callGroup.call_flows}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"_zeroed _iconed _red\",onClick:function onClick(e){e.stopPropagation();removeCallGroup(i);},children:/*#__PURE__*/_jsx(Icon,{icon:\"x-mark-1\"})})})]},i);})]}),/*#__PURE__*/_jsx(\"div\",{className:classNames('mobile-table','__show-on-mobile',{__respectAsidePanel:props.store.navActive.is}),children:/*#__PURE__*/_jsx(\"div\",{className:\"mobile-table-items\",children:callGroupsData.map(function(callGroup,i){return/*#__PURE__*/_jsxs(\"div\",{className:\"item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__top\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"b\",{children:callGroup.name})}),/*#__PURE__*/_jsx(\"div\",{children:callGroup.dispatchers})]}),/*#__PURE__*/_jsx(\"div\",{className:\"__right\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"__bottom\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"__left\"}),/*#__PURE__*/_jsx(\"div\",{className:\"__right small\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"b\",{children:callGroup.call_flows})})})]})]},i);})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fieldset\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend\",children:\"Call Phrases\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"fields\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"__left\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field _ait\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Start Phrase:\"}),/*#__PURE__*/_jsx(\"textarea\",{defaultValue:newCallFlowData.phrase_start,onChange:function onChange(_ref2){var value=_ref2.target.value;return setNewCallFlowData(_objectSpread(_objectSpread({},newCallFlowData),{},{phrase_start:value}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field _ait\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Office Closed:\"}),/*#__PURE__*/_jsx(\"textarea\",{defaultValue:newCallFlowData.phrase_office_closed,onChange:function onChange(_ref3){var value=_ref3.target.value;return setNewCallFlowData(_objectSpread(_objectSpread({},newCallFlowData),{},{phrase_office_closed:value}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field _ait\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Office Temporary Closed:\"}),/*#__PURE__*/_jsx(\"textarea\",{defaultValue:newCallFlowData.phrase_office_temporary_closed,onChange:function onChange(_ref4){var value=_ref4.target.value;return setNewCallFlowData(_objectSpread(_objectSpread({},newCallFlowData),{},{phrase_office_temporary_closed:value}));}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"__right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field _ait\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Phone Number Not Available:\"}),/*#__PURE__*/_jsx(\"textarea\",{defaultValue:newCallFlowData.phrase_phone_not_available,onChange:function onChange(_ref5){var value=_ref5.target.value;return setNewCallFlowData(_objectSpread(_objectSpread({},newCallFlowData),{},{phrase_phone_not_available:value}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field _ait\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Dispatchers Not Available:\"}),/*#__PURE__*/_jsx(\"textarea\",{defaultValue:newCallFlowData.phrase_dispatcher_not_available,onChange:function onChange(_ref6){var value=_ref6.target.value;return setNewCallFlowData(_objectSpread(_objectSpread({},newCallFlowData),{},{phrase_dispatcher_not_available:value}));}})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper flex-container sb editing-buttons\",children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"_bordered _red\",onClick:function onClick(){return $router.router.navigate('call_center.callFlows',{},{reload:true});},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{disabled:!readyToSave,className:\"_bordered _green\",children:\"Save\"})]})]})]}):null});});export default CallCenter_CallFlowsPage_New;","map":{"version":3,"sources":["/Users/nicole/rrrr/crm/src/pages/CallCenter/CallFlows/New.tsx"],"names":["axios","useEffect","useState","connect","Icon","nError","mapDispatchToProps","mapStateToProps","Select","BaseLink","useRoute","classNames","emptyCallGroup","call_group_id","name","dispatchers","call_flows","CallCenter_CallFlowsPage_New","props","readyToSave","setReadyToSave","$router","callGroupsData","setCallGroupsData","callGroups","setCallGroups","availableCallGroups","setAvailableCallGroups","selectedCallGroup","setSelectedCallGroup","phrase_start","phrase_office_closed","phrase_office_temporary_closed","phrase_phone_not_available","phrase_dispatcher_not_available","newCallFlowData","setNewCallFlowData","loadInfo","get","callFlowsData","data","edit","call_groups","concat","setTimeout","addCallGroup","newCallGroupsList","_availableCallGroups","filter","$callGroup","findIndex","callGroup","removeCallGroup","i","_callFlowCallGroups","_callGroup","splice","router","_active","route","value","target","map","span","find","__respectAsidePanel","store","navActive","is","e","stopPropagation","navigate","reload"],"mappings":"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","sourcesContent":["import axios from \"axios\"\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport Icon from \"../../../components/Icon\"\nimport { nError } from \"../../../funcs\"\nimport { StoreDispatch, StoreState, mapDispatchToProps, mapStateToProps } from \"../../../store\";\n\nimport \"../../../styles/pages/common/entity-edit.sass\"\nimport Select from \"../../../components/Select\"\nimport Checkbox from \"../../../components/Checkbox\"\nimport { BaseLink, useRoute } from \"react-router5\"\nimport { CallCenter_CallFlow, CallCenter_CallGroup } from \"../../../models/CallCenter\"\nimport classNames from \"classnames\"\n\ninterface Props {\n  store: StoreState,\n  dispatcher: StoreDispatch\n}\n\nconst emptyCallGroup: Partial<CallCenter_CallGroup> = {\n  call_group_id: '',\n  name: '',\n  dispatchers: '',\n  call_flows: ''\n}\n\nconst CallCenter_CallFlowsPage_New = connect(mapStateToProps, mapDispatchToProps)(function(props: Props) {\n\n  const [readyToSave, setReadyToSave] = useState(false)\n\n  const $router = useRoute()\n\n  const [callGroupsData, setCallGroupsData] = useState<CallCenter_CallGroup[]>([])\n\n  const [callGroups, setCallGroups] = useState<CallCenter_CallGroup[] | null>(null)\n  const [availableCallGroups, setAvailableCallGroups] = useState<Partial<CallCenter_CallGroup>[]>([])\n  const [selectedCallGroup, setSelectedCallGroup] = useState<Partial<CallCenter_CallGroup>>(emptyCallGroup)\n  const [newCallFlowData, setNewCallFlowData] = useState({\n    name: '',\n    phrase_start: '',\n    phrase_office_closed: '',\n    phrase_office_temporary_closed: '',\n    phrase_phone_not_available: '',\n    phrase_dispatcher_not_available: ''\n  })\n  \n  // Load info function\n  async function loadInfo() {\n    try {\n      const { data: callFlowsData } = (await axios.get('/json/call_center_call_flows.json'))\n\n      setCallGroups(callFlowsData.edit.call_groups)\n\n      setAvailableCallGroups([emptyCallGroup].concat(callFlowsData.edit.call_groups))\n\n      setSelectedCallGroup(emptyCallGroup)\n\n      setTimeout(() => setReadyToSave(false), 100)\n    }\n    catch (error) {\n      nError(error)\n    }\n  }\n\n  // Load callFlow data\n  useEffect(() => {\n    loadInfo()\n  }, [])\n\n  // Add callGroup function\n  function addCallGroup() {\n\n    if (!callGroupsData || !newCallFlowData) return\n\n    const newCallGroupsList = [\n      ...callGroupsData,\n      selectedCallGroup\n    ]\n\n    setCallGroupsData(newCallGroupsList as any)\n\n    let _availableCallGroups = [...availableCallGroups]\n\n    _availableCallGroups = _availableCallGroups.filter(($callGroup) => {\n      \n      return newCallGroupsList.findIndex((callGroup) => {\n        return callGroup.name === $callGroup.name\n      }) === -1\n    })\n\n    setAvailableCallGroups([\n      ..._availableCallGroups\n    ])\n\n    setSelectedCallGroup(emptyCallGroup)\n\n    setReadyToSave(true)\n  }\n\n  // Remove callGroup function\n  function removeCallGroup(i: number) {\n\n    let _callFlowCallGroups = [...callGroupsData]\n\n    let _callGroup = _callFlowCallGroups[i]\n    \n    _callFlowCallGroups.splice(i, 1)\n\n    setCallGroupsData(_callFlowCallGroups)\n\n    setAvailableCallGroups([\n      ...availableCallGroups,\n      _callGroup\n    ])\n\n    setReadyToSave(true)\n  }\n\n  useEffect(() => setReadyToSave(true), [\n    newCallFlowData\n  ])\n  \n  // Render function\n  return (<>\n    {true ? (\n      <div className=\"CallCenter_CallFlowsPage_New entity-edit\">\n\n        {/* Top navigation */}\n        <div className=\"top-nav\">\n          <BaseLink router={$router.router} routeName=\"call_center.phoneNumbers\" className={classNames({_active: $router.route.name === \"call_center.phoneNumbers\"})}>\n            <Icon icon=\"phone-1\" />\n            <span>Phone Numbers</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.dispatchers\" className={classNames({_active: $router.route.name === \"call_center.dispatchers\"})}>\n            <Icon icon=\"user-1\" />\n            <span>Dispatchers</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.groups\" className={classNames({_active: $router.route.name === \"call_center.groups\"})}>\n            <Icon icon=\"user-29\" />\n            <span>Groups</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.callFlows\" className={classNames({_active: $router.route.name === \"call_center.callFlows\"})}>\n            <Icon icon=\"share-7\" />\n            <span>Call Flows</span>\n          </BaseLink>\n\n          <BaseLink router={$router.router} routeName=\"call_center.settings\" className={classNames({_active: $router.route.name === \"call_center.settings\"})}>\n            <Icon icon=\"gear-1\" />\n            <span>Settings</span>\n          </BaseLink>\n        </div>\n\n        <div className=\"wrapper flex-container sb\">\n          <h1>New Call Flow</h1>\n        </div>\n        \n        <div className=\"fieldset\">\n          \n          <div className=\"legend\">Main</div>\n\n          <div className=\"fields\">\n\n            <div className=\"__left\">\n              <div className=\"field\">\n                <span>Name:</span>\n                <input type=\"text\" onChange={({target: {value}}) => setNewCallFlowData({...newCallFlowData, name: value})} />\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"fieldset\">\n\n          <div className=\"flex-container sb wrap\">\n            <div className=\"legend\">Call Groups</div>\n\n            <div className=\"legend-action-wrapper\">\n              <label>Call Group:</label>\n              <div className=\"input-wrapper\">\n                <Select options={availableCallGroups.map((callGroup) => ({\n                  span: callGroup.name as string,\n                  value: callGroup.name as string\n                }))} selectedOption={selectedCallGroup.name as string} onChange={(value) => setSelectedCallGroup(availableCallGroups.find((_callGroup) => _callGroup.name === value) as CallCenter_CallGroup)}/>\n                <button disabled={!selectedCallGroup.name} className=\"_green\" onClick={() => addCallGroup()}>\n                  Add\n                </button>\n              </div>\n            </div>\n          </div>\n\n          <table className={classNames('table', '__hide-on-mobile', {\n            __respectAsidePanel: props.store.navActive.is\n          })}>\n            <tr>\n              <th>Name</th>\n              <th>Dispatchers</th>\n              <th>Call Flow</th>\n              <th></th>\n            </tr>\n            {(callGroupsData as CallCenter_CallGroup[]).map((callGroup, i) => (\n              <tr key={i}>\n                <td>{callGroup.name}</td>\n                <td>{callGroup.dispatchers}</td>\n                <td>{callGroup.call_flows}</td>\n                <td>\n                  <button className=\"_zeroed _iconed _red\" onClick={(e) => { e.stopPropagation(); removeCallGroup(i) }}>\n                    <Icon icon=\"x-mark-1\" />\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </table>\n\n          <div className={classNames('mobile-table', '__show-on-mobile', {\n            __respectAsidePanel: props.store.navActive.is\n          })}>\n\n            <div className=\"mobile-table-items\">\n\n              {callGroupsData.map((callGroup, i: number) => (\n              <div className=\"item\" key={i}>\n\n                <div className=\"__top\">\n\n                  <div className=\"__left\">\n                    <div><b>{callGroup.name}</b></div>\n                    <div>\n                      {callGroup.dispatchers}\n                    </div>\n                  </div>\n\n                  <div className=\"__right\">\n                    \n                  </div>\n                </div>\n\n                <div className=\"__bottom\">\n\n                  <div className=\"__left\">\n                    \n                  </div>\n\n                  <div className=\"__right small\">\n                    <div>\n                      <b>{callGroup.call_flows}</b>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"fieldset\">\n\n          <div className=\"legend\">Call Phrases</div>\n\n          <div className=\"fields\">\n\n            <div className=\"__left\">\n              <div className=\"field _ait\">\n                <span>Start Phrase:</span>\n                <textarea defaultValue={newCallFlowData.phrase_start} onChange={({target: {value}}) => setNewCallFlowData({...newCallFlowData, phrase_start: value})}></textarea>\n              </div>\n\n              <div className=\"field _ait\">\n                <span>Office Closed:</span>\n                <textarea defaultValue={newCallFlowData.phrase_office_closed} onChange={({target: {value}}) => setNewCallFlowData({...newCallFlowData, phrase_office_closed: value})}></textarea>\n              </div>\n\n              <div className=\"field _ait\">\n                <span>Office Temporary Closed:</span>\n                <textarea defaultValue={newCallFlowData.phrase_office_temporary_closed} onChange={({target: {value}}) => setNewCallFlowData({...newCallFlowData, phrase_office_temporary_closed: value})}></textarea>\n              </div>\n            </div>\n\n            <div className=\"__right\">\n              <div className=\"field _ait\">\n                <span>Phone Number Not Available:</span>\n                <textarea defaultValue={newCallFlowData.phrase_phone_not_available} onChange={({target: {value}}) => setNewCallFlowData({...newCallFlowData, phrase_phone_not_available: value})}></textarea>\n              </div>\n\n              <div className=\"field _ait\">\n                <span>Dispatchers Not Available:</span>\n                <textarea defaultValue={newCallFlowData.phrase_dispatcher_not_available} onChange={({target: {value}}) => setNewCallFlowData({...newCallFlowData, phrase_dispatcher_not_available: value})}></textarea>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"wrapper flex-container sb editing-buttons\">\n          <div />\n          <div className=\"buttons\">\n            <button className=\"_bordered _red\" onClick={() => $router.router.navigate('call_center.callFlows', {}, {\n              reload: true\n            })}>\n              Cancel\n            </button>\n            <button disabled={!readyToSave} className=\"_bordered _green\">\n              Save\n            </button>\n          </div>\n        </div>\n      </div>\n    ) : null}\n  </>)\n})\nexport default CallCenter_CallFlowsPage_New\n"]},"metadata":{},"sourceType":"module"}